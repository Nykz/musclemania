"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[137],{1137:(w,m,r)=>{r.r(m),r.d(m,{BusinessPage:()=>b});var u=r(467),e=r(3953),s=r(5239),D=r(9642),h=r(9967),d=r(2784);let S=(()=>{var a;class c{constructor(){this.apiService=(0,e.WQX)(D.G)}getCountsAndEarningsByDateRange(n,t){var o=this;return(0,u.A)(function*(){const l=o.apiService.collectionRef("students"),P=o.apiService.collectionRef("renewals"),y=(0,h.P)(l,o.apiService.whereQuery("created_at",">=",d.Dc.fromDate(n)),o.apiService.whereQuery("created_at","<=",d.Dc.fromDate(t))),B=(0,h.P)(P,o.apiService.whereQuery("created_at",">=",d.Dc.fromDate(n)),o.apiService.whereQuery("created_at","<=",d.Dc.fromDate(t))),[j,F]=yield Promise.all([o.apiService.getDocsByQuery(y),o.apiService.getDocsByQuery(B)]);let R=j.size,C=0;return F.forEach(x=>{const T=x.data();C+=T.total}),{memberCount:R,earningsSum:C}})()}}return(a=c).\u0275fac=function(n){return new(n||a)},a.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}),c})();var v=r(3202),g=r(4341);const p=()=>({weekday:"short",month:"long",day:"2-digit"}),f=()=>({hour:"2-digit",minute:"2-digit"}),_=(a,c)=>({date:a,time:c});function O(a,c){if(1&a){const i=e.RV6();e.j41(0,"ion-datetime",10),e.mxI("ngModelChange",function(t){e.eBV(i);const o=e.XpG();return e.DH7(o.model.startDate,t)||(o.model.startDate=t),e.Njj(t)}),e.bIt("ionChange",function(){e.eBV(i);const t=e.XpG();return e.Njj(t.getStatsChange())}),e.k0s()}if(2&a){const i=e.XpG();e.Y8G("formatOptions",e.l_i(4,_,e.lJ4(2,p),e.lJ4(3,f))),e.R50("ngModel",i.model.startDate)}}function M(a,c){if(1&a){const i=e.RV6();e.j41(0,"ion-datetime",11),e.mxI("ngModelChange",function(t){e.eBV(i);const o=e.XpG();return e.DH7(o.model.endDate,t)||(o.model.endDate=t),e.Njj(t)}),e.bIt("ionChange",function(){e.eBV(i);const t=e.XpG();return e.Njj(t.getStatsChange())}),e.k0s()}if(2&a){const i=e.XpG();e.Y8G("formatOptions",e.l_i(4,_,e.lJ4(2,p),e.lJ4(3,f))),e.R50("ngModel",i.model.endDate)}}let b=(()=>{var a;class c{constructor(){this.counts={},this.model={},this.global=(0,e.WQX)(v.d),this.dashboardService=(0,e.WQX)(S)}ngOnInit(){const n=new Date,t=new Date(n.getFullYear(),n.getMonth(),1),o=this.formatDateToISO(t);console.log(o);const l=n.toISOString().split("T")[0];this.model={startDate:o,endDate:l},this.getStatsChange()}ionViewDidEnter(){this.global.customStatusbar(!0)}ionViewDidLeave(){this.global.customStatusbar()}formatDateToISO(n){const t=6e4*n.getTimezoneOffset();return new Date(n.getTime()-t).toISOString().slice(0,10)}getStatsChange(){var n,t;console.log("getStatsChange"),null!==(n=this.model)&&void 0!==n&&n.startDate&&null!==(t=this.model)&&void 0!==t&&t.endDate&&this.getData(new Date(this.model.startDate),new Date(this.model.endDate))}getData(n,t){var o=this;return(0,u.A)(function*(){try{o.global.showLoader(),o.counts=yield o.dashboardService.getCountsAndEarningsByDateRange(n,t),console.log(o.counts),o.global.hideLoader()}catch(l){o.global.hideLoader(),console.log(l),o.global.checkMessageForErrorToast(l)}})()}ngOnDestroy(){}}return(a=c).\u0275fac=function(n){return new(n||a)},a.\u0275cmp=e.VBU({type:a,selectors:[["app-business"]],standalone:!0,features:[e.aNF],decls:34,vars:6,consts:[["color","primary"],["color","light"],[1,"dateRange"],["size","6"],[1,"heading",3,"align"],["datetime","datetime1"],[3,"keepContentsMounted"],["datetime","datetime2"],["color","tertiary"],[1,"ion-text-center"],["id","datetime1","presentation","date",3,"ngModelChange","ionChange","formatOptions","ngModel"],["id","datetime2","presentation","date",3,"ngModelChange","ionChange","formatOptions","ngModel"]],template:function(n,t){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3,"Business"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-row",2)(6,"ion-col",3)(7,"div",4),e.EFF(8,"FROM"),e.k0s(),e.nrm(9,"ion-datetime-button",5),e.j41(10,"ion-modal",6),e.DNE(11,O,1,7,"ng-template"),e.k0s()(),e.j41(12,"ion-col",3)(13,"div",4),e.EFF(14,"TO"),e.k0s(),e.nrm(15,"ion-datetime-button",7),e.j41(16,"ion-modal",6),e.DNE(17,M,1,7,"ng-template"),e.k0s()()(),e.j41(18,"ion-grid")(19,"ion-row")(20,"ion-col",3)(21,"ion-card",8)(22,"ion-card-content",9)(23,"ion-text"),e.EFF(24),e.k0s(),e.j41(25,"p"),e.EFF(26,"Members"),e.k0s()()()(),e.j41(27,"ion-col",3)(28,"ion-card",0)(29,"ion-card-content",9)(30,"ion-text"),e.EFF(31),e.k0s(),e.j41(32,"p"),e.EFF(33,"Total Earnings"),e.k0s()()()()()()()),2&n&&(e.R7$(7),e.Y8G("align","center"),e.R7$(3),e.Y8G("keepContentsMounted",!0),e.R7$(3),e.Y8G("align","center"),e.R7$(3),e.Y8G("keepContentsMounted",!0),e.R7$(8),e.SpI(" ",(null==t.counts?null:t.counts.memberCount)||0," "),e.R7$(7),e.SpI(" ",(null==t.counts?null:t.counts.earningsSum)||0," "))},dependencies:[s.K4,s.A9,s.Sb,s.IO,s.I9,s.b_,s.hU,s.ln,s.lO,s.W9,s.eU,s.BC,s.ai,g.YN,g.BC,g.vS],styles:["ion-card[_ngcontent-%COMP%]{margin:5px}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:10px 5px;border-bottom:1px dashed #fff}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:1.5rem}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{background-color:#fff;border-radius:50%;font-size:1.2rem;vertical-align:middle}ion-row.dateRange[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{border:1px solid var(--ion-color-medium)}ion-row.dateRange[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.75rem;margin-bottom:5px}"]}),c})()}}]);