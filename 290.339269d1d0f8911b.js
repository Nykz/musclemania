"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[290],{8655:(T,h,l)=>{l.d(h,{V:()=>E});var m=l(177),e=l(5239),i=l(3953);const P=c=>({transform:c});function r(c,C){if(1&c&&(i.j41(0,"ion-text")(1,"p"),i.EFF(2),i.k0s()()),2&c){const u=i.XpG();i.R7$(2),i.JRh(u.model.subTitle)}}let E=(()=>{var c;class C{constructor(){this.fontSize="18rem",this.isMargin="translateY(10vh)"}ngOnInit(){}}return(c=C).\u0275fac=function(f){return new(f||c)},c.\u0275cmp=i.VBU({type:c,selectors:[["app-empty-screen"]],inputs:{model:"model",fontSize:"fontSize",isMargin:"isMargin"},standalone:!0,features:[i.aNF],decls:9,vars:9,consts:[[3,"ngStyle"],[1,"ion-text-center"],[3,"name","color"],[4,"ngIf"]],template:function(f,d){1&f&&(i.j41(0,"ion-grid",0)(1,"ion-row")(2,"ion-col",1),i.nrm(3,"ion-icon",2),i.k0s()(),i.j41(4,"ion-row")(5,"ion-col",1)(6,"ion-label"),i.EFF(7),i.k0s(),i.DNE(8,r,3,1,"ion-text",3),i.k0s()()()),2&f&&(i.Y8G("ngStyle",i.eq3(7,P,d.model.noSpace?"0vh":d.isMargin)),i.R7$(3),i.xc7("font-size",d.fontSize),i.Y8G("name",d.model.icon)("color",d.model.color?d.model.color:"tertiary"),i.R7$(4),i.SpI(" ",d.model.title," "),i.R7$(),i.Y8G("ngIf",null==d.model?null:d.model.subTitle))},dependencies:[e.lO,e.ln,e.hU,e.iq,e.he,e.IO,m.bT,m.B3]}),C})()},3290:(T,h,l)=>{l.r(h),l.d(h,{PtCategoriesPage:()=>I});var m=l(467),e=l(3953),i=l(9967),P=l(4341),r=l(5239),E=l(5079),c=l(5873),C=l(8655),u=l(9642),f=l(3202);const d=()=>[.5,.9,1];function k(s,g){if(1&s){const a=e.RV6();e.j41(0,"ion-item",7)(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-button",11),e.bIt("click",function(){const t=e.eBV(a).$implicit,n=e.XpG();return e.Njj(n.editCategory(t))}),e.nrm(4,"ion-icon",12),e.k0s(),e.j41(5,"ion-button",13),e.bIt("click",function(){const t=e.eBV(a).$implicit,n=e.XpG();return e.Njj(n.deleteCategory(t))}),e.nrm(6,"ion-icon",14),e.k0s()()}if(2&s){const a=g.$implicit;e.R7$(2),e.SpI(" ",null==a?null:a.name," ")}}function D(s,g){if(1&s&&e.nrm(0,"app-empty-screen",8),2&s){const a=e.XpG();e.Y8G("model",a.emptyModel)}}function O(s,g){if(1&s){const a=e.RV6();e.j41(0,"ion-button",19),e.bIt("click",function(){e.eBV(a);const t=e.XpG(2),n=e.sdS(16);return e.Njj(t.save(n))}),e.j41(1,"ion-text"),e.EFF(2,"SAVE"),e.k0s()()}if(2&s){const a=e.XpG(2);e.Y8G("disabled",!a.name||""==a.name.trim())}}function j(s,g){1&s&&(e.j41(0,"ion-button",18),e.nrm(1,"ion-spinner",20),e.k0s())}function S(s,g){if(1&s){const a=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s()()(),e.j41(4,"ion-content")(5,"div",15)(6,"ion-input",16),e.mxI("ngModelChange",function(t){e.eBV(a);const n=e.XpG();return e.DH7(n.name,t)||(n.name=t),e.Njj(t)}),e.k0s(),e.j41(7,"div",7),e.DNE(8,O,3,1,"ion-button",17)(9,j,2,0,"ion-button",18),e.k0s()()()}if(2&s){const a=e.XpG();e.R7$(3),e.SpI("",a.name?"Edit":"Add"," PT Category"),e.R7$(3),e.R50("ngModel",a.name),e.R7$(2),e.vxM(a.isSave?9:8)}}let I=(()=>{var s;class g{constructor(){this.categories=[],this.isAddCategory=!1,this.isSave=!1,this.emptyModel={title:"No categories added yet",icon:"briefcase-outline"},this.apiService=(0,e.WQX)(u.G),this.global=(0,e.WQX)(f.d),(0,E.a)({createOutline:c.hmR,addCircle:c.YH_,trashOutline:c.P1A})}ngOnInit(){this.getCategories()}getCategories(o){var t=this;return(0,m.A)(function*(){try{const n=t.apiService.collectionFirestoreRef("pt_package_categories");let _=(0,i.P)(n,t.apiService.limitQuery(10));t.lastVisible&&o&&(_=(0,i.P)(_,t.apiService.startAfterQuery(t.lastVisible)));const p=yield t.apiService.getDocsByQuery(_);t.lastVisible=p.docs[p.docs.length-1],console.log("last",t.lastVisible);const y=yield p.docs.map(b=>{let M=b.data();return M.id=b.id,M});console.log("categories",y);let v=t.categories;v=v.concat(y),t.categories=v}catch(n){console.log(n),t.global.checkMessageForErrorToast(n)}})()}loadMore(o){var t=this;return(0,m.A)(function*(){try{console.log(o);const n=yield t.getCategories(!0);console.log(n),setTimeout(()=>{o.target.complete()},500)}catch(n){console.log(n),t.global.checkMessageForErrorToast(n)}})()}editCategory(o){this.isAddCategory=!0,this.name=null==o?void 0:o.name,this.id=null==o?void 0:o.id}reset(){this.isAddCategory=!1,this.id=null,this.name=null}save(o){var t=this;return(0,m.A)(function*(){try{if(t.isSave=!0,t.id){const n=yield t.apiService.updateDocument(`pt_package_categories/${t.id}`,{name:t.name});console.log(n);const _=t.categories.findIndex(p=>p.id==t.id);t.categories[_]={id:t.id,name:t.name}}else{const _={id:(yield t.apiService.addDocument("pt_package_categories",{name:t.name})).id,name:t.name};t.categories=t.categories.concat(_)}t.isSave=!1,o.dismiss()}catch(n){console.log(n),t.isSave=!1,t.global.checkMessageForErrorToast(n)}})()}deleteCategory(o){this.global.showAlert(`Are you sure you want to exclude '${null==o?void 0:o.name}' from the list?`,"Confirm",[{text:"No",role:"cancel"},{text:"Yes",handler:()=>{this.removeCategory(o)}}])}removeCategory(o){var t=this;return(0,m.A)(function*(){try{t.global.showLoader();const n=yield t.apiService.deleteDocument(`pt_package_categories/${null==o?void 0:o.id}`);console.log(n),t.categories=t.categories.filter(_=>_.id!=(null==o?void 0:o.id)),t.global.hideLoader()}catch(n){console.log(n),t.global.hideLoader(),t.global.checkMessageForErrorToast(n)}})()}}return(s=g).\u0275fac=function(o){return new(o||s)},s.\u0275cmp=e.VBU({type:s,selectors:[["app-pt-categories"]],standalone:!0,features:[e.aNF],decls:18,vars:5,consts:[["add_category_modal",""],["color","secondary"],["slot","start"],["defaultHref","/pt-packages"],["slot","end"],["color","primary",3,"click"],["slot","icon-only","name","add-circle"],[1,"ion-margin-top"],[3,"model"],[3,"ionInfinite"],[3,"didDismiss","isOpen","breakpoints","initialBreakpoint"],["fill","clear","slot","end","color","tertiary",3,"click"],["name","create-outline"],["fill","clear","slot","end","color","danger",3,"click"],["name","trash-outline"],[1,"ion-margin"],["label","","placeholder","Name","errorText","* Please enter the category",3,"ngModelChange","ngModel"],["expand","block","shape","round","size","large","color","tertiary",3,"disabled"],["expand","block","shape","round","size","large","color","tertiary"],["expand","block","shape","round","size","large","color","tertiary",3,"click","disabled"],["name","crescent","color","light"]],template:function(o,t){if(1&o){const n=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-title"),e.EFF(3,"PT Categories"),e.k0s(),e.j41(4,"ion-buttons",2),e.nrm(5,"ion-back-button",3),e.k0s(),e.j41(6,"ion-buttons",4)(7,"ion-button",5),e.bIt("click",function(){return e.eBV(n),e.Njj(t.isAddCategory=!0)}),e.nrm(8,"ion-icon",6),e.k0s()()()(),e.j41(9,"ion-content"),e.Z7z(10,k,7,1,"ion-item",7,e.Vm6,!1,D,1,1,"app-empty-screen",8),e.j41(13,"ion-infinite-scroll",9),e.bIt("ionInfinite",function(p){return e.eBV(n),e.Njj(t.loadMore(p))}),e.nrm(14,"ion-infinite-scroll-content"),e.k0s(),e.j41(15,"ion-modal",10,0),e.bIt("didDismiss",function(){return e.eBV(n),e.Njj(t.reset())}),e.DNE(17,S,10,3,"ng-template"),e.k0s()()}2&o&&(e.R7$(10),e.Dyx(t.categories),e.R7$(5),e.Y8G("isOpen",t.isAddCategory)("breakpoints",e.lJ4(4,d))("initialBreakpoint",.5))},dependencies:[r.Hp,r.Ax,r.he,r.uz,r.$w,r.w2,r.IO,r.Sb,r.iq,r.el,r.Jm,r.QW,r.W9,r.eU,r.BC,r.ai,P.YN,P.BC,P.vS,C.V],styles:["ion-button[size=large][_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:1rem}"]}),g})()}}]);