"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[349],{9897:(U,W,h)=>{h.d(W,{j:()=>y});var T=h(467),t=h(177),e=h(3953),b=h(4341),w=h(5239),C=h(3202),x=h(3979);function B(c,E){if(1&c&&e.EFF(0),2&c){const f=e.XpG();e.Lme(" ",null==f.member||null==f.member.pt_plan?null:f.member.pt_plan.sessions_used,"/",null==f.member||null==f.member.pt_plan?null:f.member.pt_plan.sessions," ")}}function $(c,E){if(1&c&&e.EFF(0),2&c){const f=e.XpG();e.Lme(" ",null==f.plan?null:f.plan.pt_sessions_used,"/",null==f.plan?null:f.plan.pt_sessions," ")}}function r(c,E){if(1&c&&e.EFF(0),2&c){const f=e.XpG();e.SpI(" Creating Session #",+(null==f.member||null==f.member.pt_plan?null:f.member.pt_plan.sessions_used)+1," ")}}function M(c,E){if(1&c&&e.EFF(0),2&c){const f=e.XpG();e.SpI(" Session #",null==f.session?null:f.session.session_no," ")}}function _(c,E){1&c&&e.nrm(0,"ion-datetime",22),2&c&&e.Y8G("showDefaultButtons",!0)}function d(c,E){1&c&&(e.j41(0,"div",13),e.EFF(1,"* Please select session date"),e.k0s())}function v(c,E){if(1&c&&(e.j41(0,"ion-select-option",15),e.EFF(1),e.k0s()),2&c){const f=E.$implicit;e.Y8G("value",null==f?null:f.id),e.R7$(),e.JRh(null==f?null:f.name)}}function u(c,E){if(1&c&&(e.j41(0,"ion-select-option",15),e.EFF(1),e.k0s()),2&c){const f=E.$implicit;e.Y8G("value",null==f?null:f.id),e.R7$(),e.JRh(null==f?null:f.name)}}function m(c,E){1&c&&(e.j41(0,"div",13),e.EFF(1,"* Please select trainer"),e.k0s())}function p(c,E){1&c&&e.nrm(0,"ion-datetime",23),2&c&&e.Y8G("showDefaultButtons",!0)}function s(c,E){1&c&&(e.j41(0,"div",13),e.EFF(1,"* Please select start time"),e.k0s())}function n(c,E){1&c&&e.nrm(0,"ion-datetime",24),2&c&&e.Y8G("showDefaultButtons",!0)}function a(c,E){1&c&&(e.j41(0,"div",13),e.EFF(1,"* Please select end time"),e.k0s())}function i(c,E){if(1&c){const f=e.RV6();e.j41(0,"ion-button",25),e.bIt("click",function(){e.eBV(f);const g=e.XpG();return e.Njj(g.onSubmit())}),e.j41(1,"ion-text"),e.EFF(2),e.k0s()()}if(2&c){const f=e.XpG();e.R7$(2),e.SpI("",f.session?"UPDATE":"ADD"," PT SESSION")}}function l(c,E){1&c&&(e.j41(0,"ion-button",21),e.nrm(1,"ion-spinner",26),e.k0s())}let y=(()=>{var c;class E{constructor(){this.isSave=!1,this.allTrainers=[],this.trainers=[],this.batches=[],this.close=new e.bkB,this.global=(0,e.WQX)(C.d),this.sessionService=(0,e.WQX)(x.v)}ngOnInit(){this.trainers=[...this.allTrainers],this.initForm()}initForm(){var P,g,R,F,O,I,V,N;console.log(null===(P=this.session)||void 0===P||null===(P=P.trainer)||void 0===P?void 0:P.id),this.form=new b.gE({session_date:new b.MJ(null!==(g=this.session)&&void 0!==g&&g.session_date?this.global.toIsoDateTime(new Date(null===(R=this.session)||void 0===R?void 0:R.session_date)):this.global.toIsoDateTime(new Date),{validators:[b.k0.required]}),trainer:new b.MJ(this.session?null===(F=this.session)||void 0===F||null===(F=F.trainer)||void 0===F?void 0:F.id:null,{validators:[b.k0.required]}),end_time:new b.MJ(null!==(O=this.session)&&void 0!==O&&O.end_time?this.global.toIsoDateTime(new Date(null===(I=this.session)||void 0===I?void 0:I.end_time)):this.global.toIsoDateTime(new Date),{validators:[b.k0.required]}),start_time:new b.MJ(null!==(V=this.session)&&void 0!==V&&V.start_time?this.global.toIsoDateTime(new Date(null===(N=this.session)||void 0===N?void 0:N.start_time)):this.global.toIsoDateTime(new Date(this.getStartTime())),{validators:[b.k0.required]})})}getStartTime(){var P;let g=new Date;var R;return null!==(P=this.session)&&void 0!==P&&P.end_time&&(g=new Date(null===(R=this.session)||void 0===R?void 0:R.end_time)),g.setHours(g.getHours()-1),g}getEndTime(){var P;let g=new Date;var R;return null!==(P=this.session)&&void 0!==P&&P.start_time&&(g=new Date(null===(R=this.session)||void 0===R?void 0:R.start_time)),g.setHours(g.getHours()+1),g}batchChange(P){const g=P.detail.value;console.log(g),this.trainers=this.allTrainers.filter(R=>R.batches.includes(g)),console.log(this.trainers)}onSubmit(){if(!this.form.valid)return this.global.errorToast("Please fill up all details properly"),void this.form.markAllAsTouched();this.saveSession()}saveSession(){var P=this;return(0,T.A)(function*(){try{P.isSave=!0;let I,O={...P.form.value};if(P.session){var g;const V=P.allTrainers.find(N=>N.id==O.trainer);I=yield P.sessionService.updateSession(null===(g=P.plan)||void 0===g?void 0:g.id,P.session,O,V),console.log(I)}else{var R,F;O={...O,session_no:+(null===(R=P.member)||void 0===R||null===(R=R.pt_plan)||void 0===R?void 0:R.sessions_used)+1},I=yield P.sessionService.addSession(P.member,null===(F=P.member)||void 0===F||null===(F=F.pt_plan)||void 0===F?void 0:F.id,O),console.log(I)}P.global.successToast("Session "+(P.session?"updated":"added")+" successfully"),P.isSave=!1,P.dismiss(!0)}catch(O){P.isSave=!1,console.log(O),P.global.checkMessageForErrorToast(O)}})()}dismiss(P){this.close.emit(P)}}return(c=E).\u0275fac=function(P){return new(P||c)},c.\u0275cmp=e.VBU({type:c,selectors:[["app-add-pt-session"]],inputs:{session:"session",member:"member",plan:"plan",allTrainers:"allTrainers",batches:"batches"},outputs:{close:"close"},standalone:!0,features:[e.aNF],decls:61,vars:17,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["color","light",3,"fullscreen"],[3,"formGroup"],[1,"form-row"],["size","12"],[1,"col-input"],[1,"info"],["sizeLg","6","sizeMd","6","sizeSm","12","sizeXl","6","sizeXs","12"],["lines","none"],["slot","end","datetime","datetime1"],[3,"keepContentsMounted"],[1,"error"],["label","BATCH","labelPlacement","fixed","placeholder","Select Batch",3,"ionChange"],[3,"value"],["label","TRAINER","labelPlacement","fixed","formControlName","trainer","interface","popover","placeholder","Select Trainer"],["slot","end","datetime","datetime2"],["slot","end","datetime","datetime3"],[1,"ion-margin"],["expand","block","color","tertiary","size","large"],["expand","block","size","large","color","tertiary"],["id","datetime1","presentation","date","formControlName","session_date",3,"showDefaultButtons"],["id","datetime2","presentation","time","hourCycle","h12","formControlName","start_time",3,"showDefaultButtons"],["id","datetime3","presentation","time","hourCycle","h12","formControlName","end_time",3,"showDefaultButtons"],["expand","block","color","tertiary","size","large",3,"click"],["name","crescent","color","light"]],template:function(P,g){1&P&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return g.dismiss()}),e.nrm(6,"ion-icon",2),e.k0s()()()(),e.j41(7,"ion-content",3)(8,"ion-card")(9,"form",4)(10,"ion-row",5)(11,"ion-col",6)(12,"div",7)(13,"ion-label",8),e.EFF(14),e.nI1(15,"date"),e.j41(16,"p"),e.EFF(17," Sessions used: "),e.DNE(18,B,1,2)(19,$,1,2),e.k0s(),e.j41(20,"p"),e.DNE(21,r,1,1)(22,M,1,1),e.k0s()()()(),e.j41(23,"ion-col",9)(24,"ion-item",10)(25,"ion-label"),e.EFF(26,"Session date"),e.k0s(),e.nrm(27,"ion-datetime-button",11),e.j41(28,"ion-modal",12),e.DNE(29,_,1,1,"ng-template"),e.k0s()(),e.DNE(30,d,2,0,"div",13),e.k0s(),e.j41(31,"ion-col",9)(32,"div",7)(33,"ion-select",14),e.bIt("ionChange",function(F){return g.batchChange(F)}),e.Z7z(34,v,2,2,"ion-select-option",15,e.Vm6),e.k0s()()(),e.j41(36,"ion-col",9)(37,"div",7)(38,"ion-select",16),e.Z7z(39,u,2,2,"ion-select-option",15,e.Vm6),e.k0s(),e.DNE(41,m,2,0,"div",13),e.k0s()(),e.j41(42,"ion-col",9)(43,"ion-item",10)(44,"ion-label"),e.EFF(45,"Start time"),e.k0s(),e.nrm(46,"ion-datetime-button",17),e.j41(47,"ion-modal",12),e.DNE(48,p,1,1,"ng-template"),e.k0s()(),e.DNE(49,s,2,0,"div",13),e.k0s(),e.j41(50,"ion-col",9)(51,"ion-item",10)(52,"ion-label"),e.EFF(53," End time "),e.k0s(),e.nrm(54,"ion-datetime-button",18),e.j41(55,"ion-modal",12),e.DNE(56,n,1,1,"ng-template"),e.k0s()(),e.DNE(57,a,2,0,"div",13),e.k0s()()(),e.j41(58,"div",19),e.DNE(59,i,3,1,"ion-button",20)(60,l,2,0,"ion-button",21),e.k0s()()()),2&P&&(e.R7$(3),e.SpI("",g.session?"Edit":"Add"," PT Session"),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("formGroup",g.form),e.R7$(5),e.SpI(" Plan expires on ",e.i5U(15,14,g.member?null==g.member||null==g.member.pt_plan?null:g.member.pt_plan.expiry_date:null==g.plan?null:g.plan.pt_expiry_date,"MMM d, y")," "),e.R7$(4),e.vxM(g.member?18:19),e.R7$(3),e.vxM(g.session?22:21),e.R7$(7),e.Y8G("keepContentsMounted",!0),e.R7$(2),e.vxM(g.form.get("session_date").touched&&g.form.get("session_date").hasError("required")?30:-1),e.R7$(4),e.Dyx(g.batches),e.R7$(5),e.Dyx(g.trainers),e.R7$(2),e.vxM(g.form.get("trainer").touched&&g.form.get("trainer").hasError("required")?41:-1),e.R7$(6),e.Y8G("keepContentsMounted",!0),e.R7$(2),e.vxM(g.form.get("start_time").touched&&g.form.get("start_time").hasError("required")?49:-1),e.R7$(6),e.Y8G("keepContentsMounted",!0),e.R7$(2),e.vxM(g.form.get("end_time").touched&&g.form.get("end_time").hasError("required")?57:-1),e.R7$(2),e.vxM(g.isSave?60:59))},dependencies:[w.K4,w.Sb,w.b_,w.hU,w.ln,w.he,w.uz,w.W9,w.iq,w.QW,w.BC,w.ai,w.IO,w.Jm,w.w2,w.eU,w.A9,w.Nm,w.Ip,b.X1,b.qT,b.BC,b.cb,b.j4,b.JD,t.vh],styles:["ion-button[size=large][_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:1rem}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.9rem}ion-label.info[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700}ion-label.info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:5px;font-size:.85rem}"]}),E})()},8809:(U,W,h)=>{h.d(W,{X:()=>p});var T=h(467),t=h(3953),e=h(4341),b=h(5239),w=h(1583),C=h(3202),x=h(3917);function B(s,n){if(1&s&&(t.j41(0,"ion-select-option",9),t.EFF(1),t.k0s()),2&s){const a=n.$implicit;t.Y8G("value",null==a?null:a.id),t.R7$(),t.JRh(null==a?null:a.name)}}function $(s,n){1&s&&(t.j41(0,"div",10),t.EFF(1,"* Please select plan"),t.k0s())}function r(s,n){1&s&&t.nrm(0,"ion-datetime",28),2&s&&t.Y8G("showDefaultButtons",!0)}function M(s,n){if(1&s&&(t.j41(0,"ion-select-option",9),t.EFF(1),t.k0s()),2&s){const a=n.$implicit;t.Y8G("value",null==a?null:a.id),t.R7$(),t.JRh(null==a?null:a.name)}}function _(s,n){if(1&s&&(t.j41(0,"ion-select-option",9),t.EFF(1),t.k0s()),2&s){const a=n.$implicit;t.Y8G("value",null==a?null:a.id),t.R7$(),t.JRh(null==a?null:a.name)}}function d(s,n){1&s&&t.nrm(0,"ion-datetime",29),2&s&&t.Y8G("showDefaultButtons",!0)}function v(s,n){if(1&s&&(t.j41(0,"ion-item",24)(1,"ion-label"),t.EFF(2," Total Amount Payable "),t.k0s(),t.j41(3,"ion-text",30),t.EFF(4,"\u20b9"),t.j41(5,"strong"),t.EFF(6),t.k0s()()()),2&s){const a=t.XpG();t.R7$(6),t.JRh(a.total_amount)}}function u(s,n){if(1&s){const a=t.RV6();t.j41(0,"ion-button",31),t.bIt("click",function(){t.eBV(a);const l=t.XpG();return t.Njj(l.onSubmit())}),t.j41(1,"ion-text"),t.EFF(2),t.k0s()()}if(2&s){const a=t.XpG();t.R7$(2),t.JRh(a.plan?"UPDATE":"RENEW")}}function m(s,n){1&s&&(t.j41(0,"ion-button",27),t.nrm(1,"ion-spinner",32),t.k0s())}let p=(()=>{var s;class n{constructor(){this.isSave=!1,this.plans=[],this.all_pt_plans=[],this.pt_plans=[],this.pt_categories=[],this.total_amount=0,this.close=new t.bkB,this.customerService=(0,t.WQX)(w.m),this.renewService=(0,t.WQX)(x.L),this.global=(0,t.WQX)(C.d)}ngOnInit(){this.initForm(),this.getData()}initForm(){var i,l,y,c,E,f,P,g,R;this.form=new e.gE({gym_plan:new e.MJ((null===(i=this.plan)||void 0===i?void 0:i.gym_plan)||null,{validators:[e.k0.required]}),amount:new e.MJ((null===(l=this.plan)||void 0===l?void 0:l.amount)||null,{validators:[e.k0.required]}),expiry_date:new e.MJ(null!==(y=this.plan)&&void 0!==y&&y.expiry_date?this.global.toIsoDateTime(new Date(null===(c=this.plan)||void 0===c?void 0:c.expiry_date)):null,{validators:[e.k0.required]}),pt_plan:new e.MJ((null===(E=this.plan)||void 0===E?void 0:E.pt_plan)||null,{validators:[]}),pt_amount:new e.MJ((null===(f=this.plan)||void 0===f?void 0:f.pt_amount)||null,{validators:[]}),pt_expiry_date:new e.MJ(null!==(P=this.plan)&&void 0!==P&&P.pt_expiry_date?this.global.toIsoDateTime(new Date(null===(g=this.plan)||void 0===g?void 0:g.pt_expiry_date)):null,{validators:[]}),remarks:new e.MJ((null===(R=this.plan)||void 0===R?void 0:R.remarks)||null,{validators:[]})}),this.plan&&this.calculateTotalAmount()}getData(){var i=this;return(0,T.A)(function*(){try{i.plans=yield i.renewService.getGymPlans(),i.pt_categories=yield i.renewService.getPTCategories(),i.all_pt_plans=yield i.renewService.getPTPackages(),i.pt_plans=[...i.all_pt_plans]}catch(l){console.log(l),i.global.checkMessageForErrorToast(l)}})()}selectPTPackages(i){const l=i.detail.value;if(console.log(l),!l){var y;this.pt_plans=[...this.all_pt_plans];const c=null===(y=this.form.get("pt_plan"))||void 0===y?void 0:y.value;return console.log("pt_plan_val: ",c),void(c&&this.ptPlanChange(c))}this.pt_plans=this.all_pt_plans.filter(c=>c.category==l),0==this.pt_plans.length&&(this.form.patchValue({pt_plan:null,pt_amount:null,pt_expiry_date:null}),this.calculateTotalAmount()),console.log(this.pt_plans)}gymPlanChange(i){const l=i.detail.value;console.log(l);const y=this.plans.find(c=>c.id==l);this.form.patchValue({amount:(null==y?void 0:y.amount)||0,expiry_date:this.global.toIsoDateTime(this.getFutureDate(null==y?void 0:y.months,0,1))}),this.calculateTotalAmount()}ptPlanChange(i){var l;const y=(null==i||null===(l=i.detail)||void 0===l?void 0:l.value)||i;console.log(y);const c=this.pt_plans.find(E=>E.id==y);this.form.patchValue({pt_amount:(null==c?void 0:c.amount)||0,pt_expiry_date:this.global.toIsoDateTime(this.getFutureDate(0,0,-(+(null==c?void 0:c.duration)-1)))}),this.calculateTotalAmount()}calculateTotalAmount(){var i,l;this.total_amount=(+(null===(i=this.form.get("amount"))||void 0===i?void 0:i.value)||0)+(+(null===(l=this.form.get("pt_amount"))||void 0===l?void 0:l.value)||0),console.log(this.total_amount)}onSubmit(){this.form.valid?this.renewPackage():this.form.markAllAsTouched()}renewPackage(){var i=this;return(0,T.A)(function*(){try{var l;i.isSave=!0;const F=i.form.value,O=i.plans.find(N=>N.id==F.gym_plan);let V,I={gym_plan:F.gym_plan,plan_name:null==O?void 0:O.name,amount:F.amount,expiry_date:F.expiry_date,total:i.total_amount,type:"Gym"};if(null!=F&&F.pt_plan){var y,c;const N=i.all_pt_plans.find(z=>z.id==F.pt_plan);I={...I,pt_plan:null==F?void 0:F.pt_plan,pt_plan_name:null==N?void 0:N.name,pt_sessions:i.plan?+(null===(y=i.plan)||void 0===y?void 0:y.pt_sessions):+(null==N?void 0:N.sessions),pt_sessions_used:i.plan?+(null===(c=i.plan)||void 0===c?void 0:c.pt_sessions_used):0,pt_amount:null==F?void 0:F.pt_amount,pt_expiry_date:null==F?void 0:F.pt_expiry_date,type:"Gym + PT"}}if(null!=F&&F.remarks&&(I={...I,remarks:null==F?void 0:F.remarks}),i.plan){var P,g,R;const N=yield i.customerService.getMemberData(null===(P=i.plan)||void 0===P?void 0:P.member_id);V=yield i.renewService.updateRenewalPackage(i.plan,I,N);const z={...null===(g=V)||void 0===g?void 0:g.user_plan_data};i.customerService.updateMemberData(null===(R=i.plan)||void 0===R?void 0:R.member_id,z)}else{var E,f;I={...I,member_id:null===(E=i.member)||void 0===E?void 0:E.id},V=yield i.renewService.renewPackage(I),console.log(V);const N={...i.member,...null===(f=V)||void 0===f?void 0:f.user_plan_data};i.customerService.updateMemberValue(N)}i.global.successToast("Plan renewal successful"+(i.plan?"ly updated":"")),i.isSave=!1,i.dismiss(null===(l=V)||void 0===l?void 0:l.user_plan_data)}catch(F){i.isSave=!1,console.log(F),i.global.checkMessageForErrorToast(F)}})()}dismiss(i){this.close.emit(i)}clearPtPlan(){this.form.patchValue({pt_plan:null,pt_amount:null,pt_expiry_date:null}),this.calculateTotalAmount()}getFutureDate(i=0,l=0,y=0){const E=new Date(new Date);return i&&E.setMonth(E.getMonth()+i),l&&E.setFullYear(E.getFullYear()+l),y&&E.setDate(E.getDate()-y),E}}return(s=n).\u0275fac=function(i){return new(i||s)},s.\u0275cmp=t.VBU({type:s,selectors:[["app-renew-package"]],inputs:{member:"member",plan:"plan"},outputs:{close:"close"},standalone:!0,features:[t.aNF],decls:61,vars:12,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["color","light",3,"fullscreen"],[3,"formGroup"],[1,"form-row"],["sizeLg","6","sizeMd","6","sizeSm","12","sizeXl","6","sizeXs","12"],[1,"col-input"],["label","GYM PLANS","labelPlacement","fixed","formControlName","gym_plan","interface","popover","placeholder","Select Plan",3,"ionChange"],[3,"value"],[1,"error"],["label","AMOUNT","labelPlacement","floating","type","number","formControlName","amount","errorText","* Please enter amount",3,"ionInput","debounce"],["lines","none"],["slot","end","datetime","datetime"],[3,"keepContentsMounted"],[1,"ion-margin-top","header-color"],["slot","end","fill","clear","color","danger",3,"click"],["name","trash-outline"],[1,"pt_group"],["label","PT PLAN CATEGORIES","labelPlacement","floating","interface","popover","placeholder","Select PT Plan Categories",3,"ionChange"],["label","PT PLANS","labelPlacement","fixed","formControlName","pt_plan","interface","popover","placeholder","Select PT Plan","errorText","* Please select PT plan",3,"ionChange"],["label","PT AMOUNT","labelPlacement","floating","type","number","formControlName","pt_amount","errorText","* Please enter PT amount",3,"ionInput","debounce"],["slot","end","datetime","datetime1"],["label","REMARKS (if any)","labelPlacement","floating","rows","1","formControlName","remarks","errorText","* Please provide remarks",3,"autoGrow"],["lines","none",1,"ion-margin"],[1,"ion-margin"],["expand","block","color","tertiary","size","large"],["expand","block","size","large","color","tertiary"],["id","datetime","presentation","date","formControlName","expiry_date",3,"showDefaultButtons"],["id","datetime1","presentation","date","formControlName","pt_expiry_date",3,"showDefaultButtons"],["color","success"],["expand","block","color","tertiary","size","large",3,"click"],["name","crescent","color","light"]],template:function(i,l){1&i&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",0)(5,"ion-button",1),t.bIt("click",function(){return l.dismiss()}),t.nrm(6,"ion-icon",2),t.k0s()()()(),t.j41(7,"ion-content",3)(8,"ion-card")(9,"form",4)(10,"ion-row",5)(11,"ion-col",6)(12,"div",7)(13,"ion-select",8),t.bIt("ionChange",function(c){return l.gymPlanChange(c)}),t.Z7z(14,B,2,2,"ion-select-option",9,t.Vm6),t.k0s(),t.DNE(16,$,2,0,"div",10),t.k0s()(),t.j41(17,"ion-col",6)(18,"div",7)(19,"ion-input",11),t.bIt("ionInput",function(){return l.calculateTotalAmount()}),t.k0s()()(),t.j41(20,"ion-col",6)(21,"ion-item",12)(22,"ion-label"),t.EFF(23,"Expiry date"),t.k0s(),t.nrm(24,"ion-datetime-button",13),t.j41(25,"ion-modal",14),t.DNE(26,r,1,1,"ng-template"),t.k0s()()(),t.j41(27,"ion-item-divider",15),t.EFF(28," PT Packages (optional) "),t.j41(29,"ion-button",16),t.bIt("click",function(){return l.clearPtPlan()}),t.nrm(30,"ion-icon",17),t.k0s()(),t.j41(31,"div",18)(32,"ion-col",6)(33,"div",7)(34,"ion-select",19),t.bIt("ionChange",function(c){return l.selectPTPackages(c)}),t.j41(35,"ion-select-option",9),t.EFF(36,"All"),t.k0s(),t.Z7z(37,M,2,2,"ion-select-option",9,t.Vm6),t.k0s()()(),t.j41(39,"ion-col",6)(40,"div",7)(41,"ion-select",20),t.bIt("ionChange",function(c){return l.ptPlanChange(c)}),t.Z7z(42,_,2,2,"ion-select-option",9,t.Vm6),t.k0s()()(),t.j41(44,"ion-col",6)(45,"div",7)(46,"ion-input",21),t.bIt("ionInput",function(){return l.calculateTotalAmount()}),t.k0s()()(),t.j41(47,"ion-col",6)(48,"ion-item",12)(49,"ion-label"),t.EFF(50,"PT Expiry date"),t.k0s(),t.nrm(51,"ion-datetime-button",22),t.j41(52,"ion-modal",14),t.DNE(53,d,1,1,"ng-template"),t.k0s()()()(),t.j41(54,"ion-col",6)(55,"div",7),t.nrm(56,"ion-textarea",23),t.k0s()()(),t.DNE(57,v,7,1,"ion-item",24),t.k0s(),t.j41(58,"div",25),t.DNE(59,u,3,1,"ion-button",26)(60,m,2,0,"ion-button",27),t.k0s()()()),2&i&&(t.R7$(3),t.JRh(l.plan?"Edit Plan":"Plan Renewal"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(2),t.Y8G("formGroup",l.form),t.R7$(5),t.Dyx(l.plans),t.R7$(2),t.vxM(l.form.get("gym_plan").touched&&l.form.get("gym_plan").hasError("required")?16:-1),t.R7$(3),t.Y8G("debounce",800),t.R7$(6),t.Y8G("keepContentsMounted",!0),t.R7$(10),t.Y8G("value",null),t.R7$(2),t.Dyx(l.pt_categories),t.R7$(5),t.Dyx(l.pt_plans),t.R7$(4),t.Y8G("debounce",800),t.R7$(6),t.Y8G("keepContentsMounted",!0),t.R7$(4),t.Y8G("autoGrow",!0),t.R7$(),t.vxM(l.total_amount>0?57:-1),t.R7$(2),t.vxM(l.isSave?60:59))},dependencies:[b.K4,b.Sb,b.Dg,b.b_,b.nc,b.$w,b.hU,b.ln,b.he,b.uz,b.W9,b.iq,b.QW,b.BC,b.ai,b.IO,b.Jm,b.w2,b.eU,b.Nm,b.Ip,b.A9,e.X1,e.qT,e.BC,e.cb,e.j4,e.JD],styles:["ion-button[size=large][_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:1rem}div.pt_group[_ngcontent-%COMP%]{border:1px dashed var(--ion-color-medium);width:-webkit-fill-available}ion-item-divider[_ngcontent-%COMP%]{--background: #fff;font-size:.85rem}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.9rem}"]}),n})()},5109:(U,W,h)=>{h.d(W,{X:()=>u});var T=h(467),t=h(3953),e=h(4341),b=h(5239),w=h(1583),C=h(3202),x=h(3917);function B(m,p){if(1&m&&(t.j41(0,"ion-select-option",9),t.EFF(1),t.k0s()),2&m){const s=p.$implicit;t.Y8G("value",null==s?null:s.id),t.R7$(),t.JRh(null==s?null:s.name)}}function $(m,p){if(1&m&&(t.j41(0,"ion-select-option",9),t.EFF(1),t.k0s()),2&m){const s=p.$implicit;t.Y8G("value",null==s?null:s.id),t.R7$(),t.JRh(null==s?null:s.name)}}function r(m,p){1&m&&(t.j41(0,"div",11),t.EFF(1,"* Please select plan"),t.k0s())}function M(m,p){1&m&&t.nrm(0,"ion-datetime",21),2&m&&t.Y8G("showDefaultButtons",!0)}function _(m,p){if(1&m&&(t.j41(0,"ion-item",17)(1,"ion-label"),t.EFF(2," Total Amount Payable "),t.k0s(),t.j41(3,"ion-text",22),t.EFF(4,"\u20b9"),t.j41(5,"strong"),t.EFF(6),t.k0s()()()),2&m){const s=t.XpG();t.R7$(6),t.JRh(s.total_amount)}}function d(m,p){if(1&m){const s=t.RV6();t.j41(0,"ion-button",23),t.bIt("click",function(){t.eBV(s);const a=t.XpG();return t.Njj(a.onSubmit())}),t.j41(1,"ion-text"),t.EFF(2),t.k0s()()}if(2&m){const s=t.XpG();t.R7$(2),t.SpI("",s.plan?"UPDATE":"ADD"," PT PLAN")}}function v(m,p){1&m&&(t.j41(0,"ion-button",20),t.nrm(1,"ion-spinner",24),t.k0s())}let u=(()=>{var m;class p{constructor(){this.isSave=!1,this.all_pt_plans=[],this.pt_plans=[],this.pt_categories=[],this.total_amount=0,this.close=new t.bkB,this.customerService=(0,t.WQX)(w.m),this.renewService=(0,t.WQX)(x.L),this.global=(0,t.WQX)(C.d)}ngOnInit(){this.initForm(),this.getData()}initForm(){var n,a,i,l,y;this.form=new e.gE({pt_plan:new e.MJ((null===(n=this.plan)||void 0===n?void 0:n.pt_plan)||null,{validators:[e.k0.required]}),pt_amount:new e.MJ((null===(a=this.plan)||void 0===a?void 0:a.pt_amount)||null,{validators:[e.k0.required]}),pt_expiry_date:new e.MJ(null!==(i=this.plan)&&void 0!==i&&i.pt_expiry_date?this.global.toIsoDateTime(new Date(null===(l=this.plan)||void 0===l?void 0:l.pt_expiry_date)):null,{validators:[e.k0.required]}),remarks:new e.MJ((null===(y=this.plan)||void 0===y?void 0:y.remarks)||null,{validators:[]})}),this.plan&&this.calculateTotalAmount()}getData(){var n=this;return(0,T.A)(function*(){try{n.pt_categories=yield n.renewService.getPTCategories(),n.all_pt_plans=yield n.renewService.getPTPackages(),n.pt_plans=[...n.all_pt_plans]}catch(a){console.log(a),n.global.checkMessageForErrorToast(a)}})()}selectPTPackages(n){const a=n.detail.value;if(console.log(a),!a){var i;this.pt_plans=[...this.all_pt_plans];const l=null===(i=this.form.get("pt_plan"))||void 0===i?void 0:i.value;return console.log("pt_plan_val: ",l),void(l&&this.ptPlanChange(l))}this.pt_plans=this.all_pt_plans.filter(l=>l.category==a),0==this.pt_plans.length&&(this.form.patchValue({pt_plan:null,pt_amount:null,pt_expiry_date:null}),this.calculateTotalAmount()),console.log(this.pt_plans)}ptPlanChange(n){var a;const i=(null==n||null===(a=n.detail)||void 0===a?void 0:a.value)||n;console.log(i);const l=this.pt_plans.find(y=>y.id==i);this.form.patchValue({pt_amount:(null==l?void 0:l.amount)||0,pt_expiry_date:this.global.toIsoDateTime(this.getFutureDate(0,0,-(+(null==l?void 0:l.duration)-1)))}),this.calculateTotalAmount()}calculateTotalAmount(){var n;this.total_amount=+(null===(n=this.form.get("pt_amount"))||void 0===n?void 0:n.value)||0,console.log(this.total_amount)}onSubmit(){this.form.valid?this.renewPackage():this.form.markAllAsTouched()}renewPackage(){var n=this;return(0,T.A)(function*(){try{var a,i,l;n.isSave=!0;const g=n.form.value,R=n.all_pt_plans.find(I=>I.id==g.pt_plan);let O,F={pt_plan:null==g?void 0:g.pt_plan,pt_plan_name:null==R?void 0:R.name,pt_sessions:n.plan?+(null===(a=n.plan)||void 0===a?void 0:a.pt_sessions):+(null==R?void 0:R.sessions),pt_sessions_used:n.plan?+(null===(i=n.plan)||void 0===i?void 0:i.pt_sessions_used):0,pt_amount:null==g?void 0:g.pt_amount,pt_expiry_date:null==g?void 0:g.pt_expiry_date,total:n.total_amount,type:"PT"};if(null!=g&&g.remarks&&(F={...F,remarks:null==g?void 0:g.remarks}),n.plan){var E,f,P;const I=yield n.customerService.getMemberData(null===(E=n.plan)||void 0===E?void 0:E.member_id);O=yield n.renewService.updateRenewalPackage(n.plan,F,I);const V={...null===(f=O)||void 0===f?void 0:f.user_plan_data};n.customerService.updateMemberData(null===(P=n.plan)||void 0===P?void 0:P.member_id,V)}else{var y,c;F={...F,member_id:null===(y=n.member)||void 0===y?void 0:y.id},O=yield n.renewService.renewPackage(F),console.log(O);const I={...n.member,...null===(c=O)||void 0===c?void 0:c.user_plan_data};n.customerService.updateMemberValue(I)}n.global.successToast("Plan renewal successful"+(n.plan?"ly updated":"")),n.isSave=!1,n.dismiss(null===(l=O)||void 0===l?void 0:l.user_plan_data)}catch(g){n.isSave=!1,console.log(g),n.global.checkMessageForErrorToast(g)}})()}dismiss(n){this.close.emit(n)}clearPtPlan(){this.form.patchValue({pt_plan:null,pt_amount:null,pt_expiry_date:null}),this.calculateTotalAmount()}getFutureDate(n=0,a=0,i=0){const y=new Date(new Date);return n&&y.setMonth(y.getMonth()+n),a&&y.setFullYear(y.getFullYear()+a),i&&y.setDate(y.getDate()-i),y}}return(m=p).\u0275fac=function(n){return new(n||m)},m.\u0275cmp=t.VBU({type:m,selectors:[["app-renew-pt-package"]],inputs:{member:"member",plan:"plan"},outputs:{close:"close"},standalone:!0,features:[t.aNF],decls:41,vars:10,consts:[["slot","start"],["color","dark",3,"click"],["name","arrow-back"],["color","light",3,"fullscreen"],[3,"formGroup"],[1,"form-row"],["sizeLg","6","sizeMd","6","sizeSm","12","sizeXl","6","sizeXs","12"],[1,"col-input"],["label","PT PLAN CATEGORIES","labelPlacement","floating","interface","popover","placeholder","Select PT Plan Categories",3,"ionChange"],[3,"value"],["label","PT PLANS","labelPlacement","fixed","formControlName","pt_plan","interface","popover","placeholder","Select PT Plan","errorText","* Please select PT plan",3,"ionChange"],[1,"error"],["label","PT AMOUNT","labelPlacement","floating","type","number","formControlName","pt_amount","errorText","* Please enter PT amount",3,"ionInput","debounce"],["lines","none"],["slot","end","datetime","datetime1"],[3,"keepContentsMounted"],["label","REMARKS (if any)","labelPlacement","floating","rows","1","formControlName","remarks","errorText","* Please provide remarks",3,"autoGrow"],["lines","none",1,"ion-margin"],[1,"ion-margin"],["expand","block","color","tertiary","size","large"],["expand","block","size","large","color","tertiary"],["id","datetime1","presentation","date","formControlName","pt_expiry_date",3,"showDefaultButtons"],["color","success"],["expand","block","color","tertiary","size","large",3,"click"],["name","crescent","color","light"]],template:function(n,a){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",0)(5,"ion-button",1),t.bIt("click",function(){return a.dismiss()}),t.nrm(6,"ion-icon",2),t.k0s()()()(),t.j41(7,"ion-content",3)(8,"ion-card")(9,"form",4)(10,"ion-row",5)(11,"ion-col",6)(12,"div",7)(13,"ion-select",8),t.bIt("ionChange",function(l){return a.selectPTPackages(l)}),t.j41(14,"ion-select-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,B,2,2,"ion-select-option",9,t.Vm6),t.k0s()()(),t.j41(18,"ion-col",6)(19,"div",7)(20,"ion-select",10),t.bIt("ionChange",function(l){return a.ptPlanChange(l)}),t.Z7z(21,$,2,2,"ion-select-option",9,t.Vm6),t.k0s(),t.DNE(23,r,2,0,"div",11),t.k0s()(),t.j41(24,"ion-col",6)(25,"div",7)(26,"ion-input",12),t.bIt("ionInput",function(){return a.calculateTotalAmount()}),t.k0s()()(),t.j41(27,"ion-col",6)(28,"ion-item",13)(29,"ion-label"),t.EFF(30,"PT Expiry date"),t.k0s(),t.nrm(31,"ion-datetime-button",14),t.j41(32,"ion-modal",15),t.DNE(33,M,1,1,"ng-template"),t.k0s()()(),t.j41(34,"ion-col",6)(35,"div",7),t.nrm(36,"ion-textarea",16),t.k0s()()(),t.DNE(37,_,7,1,"ion-item",17),t.k0s(),t.j41(38,"div",18),t.DNE(39,d,3,1,"ion-button",19)(40,v,2,0,"ion-button",20),t.k0s()()()),2&n&&(t.R7$(3),t.SpI("",a.plan?"Edit":"Add"," PT Plan"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(2),t.Y8G("formGroup",a.form),t.R7$(5),t.Y8G("value",null),t.R7$(2),t.Dyx(a.pt_categories),t.R7$(5),t.Dyx(a.pt_plans),t.R7$(2),t.vxM(a.form.get("pt_plan").touched&&a.form.get("pt_plan").hasError("required")?23:-1),t.R7$(3),t.Y8G("debounce",800),t.R7$(6),t.Y8G("keepContentsMounted",!0),t.R7$(4),t.Y8G("autoGrow",!0),t.R7$(),t.vxM(a.total_amount>0?37:-1),t.R7$(2),t.vxM(a.isSave?40:39))},dependencies:[b.K4,b.Sb,b.b_,b.nc,b.$w,b.hU,b.ln,b.he,b.uz,b.W9,b.iq,b.QW,b.BC,b.ai,b.IO,b.Jm,b.w2,b.eU,b.Nm,b.Ip,b.A9,e.X1,e.qT,e.BC,e.cb,e.j4,e.JD],styles:["ion-button[size=large][_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:1rem}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.9rem}"]}),p})()},349:(U,W,h)=>{h.r(W),h.d(W,{routes:()=>_e});var T=h(467),t=h(177),e=h(3953),b=h(9384),w=h(600),C=h(5239),x=h(9685),B=h(1583),$=h(3202),r=h(4341);function M(S,j){1&S&&e.nrm(0,"ion-datetime",42),2&S&&e.Y8G("showDefaultButtons",!0)}function _(S,j){1&S&&(e.j41(0,"div",24),e.EFF(1,"* Please select gender"),e.k0s())}function d(S,j){1&S&&(e.j41(0,"div",24),e.EFF(1,"* Please select height"),e.k0s())}function v(S,j){1&S&&(e.j41(0,"div",24),e.EFF(1,"* Please select membership type"),e.k0s())}function u(S,j){if(1&S){const D=e.RV6();e.j41(0,"ion-button",43),e.bIt("click",function(){e.eBV(D);const o=e.XpG();return e.Njj(o.onSubmit())}),e.j41(1,"ion-text"),e.EFF(2,"SAVE"),e.k0s()()}}function m(S,j){1&S&&(e.j41(0,"ion-button",41),e.nrm(1,"ion-spinner",44),e.k0s())}let p=(()=>{var S;class j{constructor(){this.isSave=!1,this.close=new e.bkB,this.customerService=(0,e.WQX)(B.m),this.global=(0,e.WQX)($.d)}ngOnInit(){this.initForm()}initForm(){var k,o,A,G,X,L,Q,Y,J,K,H,Z,q,ee,te;this.form=new r.gE({serial_no:new r.MJ(null===(k=this.member)||void 0===k?void 0:k.serial_no,{validators:[r.k0.required]}),name:new r.MJ(null===(o=this.member)||void 0===o?void 0:o.name,{validators:[r.k0.required]}),email:new r.MJ(null===(A=this.member)||void 0===A?void 0:A.email,{validators:[r.k0.email]}),phone:new r.MJ(null===(G=this.member)||void 0===G?void 0:G.phone,{validators:[r.k0.required,r.k0.minLength(10),r.k0.maxLength(10)]}),dob:new r.MJ(this.global.toIsoDateTime(new Date(null===(X=this.member)||void 0===X?void 0:X.dob)),{validators:[r.k0.required]}),weight:new r.MJ(null===(L=this.member)||void 0===L?void 0:L.weight,{validators:[r.k0.required]}),gender:new r.MJ(null===(Q=this.member)||void 0===Q?void 0:Q.gender,{validators:[r.k0.required]}),feet:new r.MJ(null===(Y=this.member)||void 0===Y?void 0:Y.feet,{validators:[r.k0.required]}),inches:new r.MJ(null===(J=this.member)||void 0===J?void 0:J.inches,{validators:[r.k0.required]}),address:new r.MJ(null===(K=this.member)||void 0===K?void 0:K.address,{validators:[r.k0.required]}),membership_type:new r.MJ(null===(H=this.member)||void 0===H?void 0:H.membership_type,{validators:[r.k0.required]}),guardian_name:new r.MJ(null===(Z=this.member)||void 0===Z?void 0:Z.guardian_name,{validators:[r.k0.required]}),guardian_relation:new r.MJ(null===(q=this.member)||void 0===q?void 0:q.guardian_relation,{validators:[r.k0.required]}),guardian_phone:new r.MJ(null===(ee=this.member)||void 0===ee?void 0:ee.guardian_phone,{validators:[r.k0.required,r.k0.minLength(10),r.k0.maxLength(10)]}),status:new r.MJ(null===(te=this.member)||void 0===te?void 0:te.status,{validators:[r.k0.required]})})}takePicture(){var k=this;return(0,T.A)(function*(){k.photo=yield k.global.takePicture(!1)})()}onSubmit(){this.form.valid?this.updateMember():this.form.markAllAsTouched()}updateMember(){var k=this;return(0,T.A)(function*(){try{let o;k.isSave=!0,k.photo&&(o=yield k.global.getBlob(k.photo.base64String));const A={...k.form.value,short_name:k.form.value.name.toLowerCase()},G=yield k.customerService.updateMember(k.member,A,k.photo,o);console.log(G),k.global.successToast("Member updated successfully"),k.isSave=!1,k.dismiss(G)}catch(o){k.isSave=!1,console.log(o),k.global.checkMessageForErrorToast(o)}})()}dismiss(k){this.close.emit(k)}}return(S=j).\u0275fac=function(k){return new(k||S)},S.\u0275cmp=e.VBU({type:S,selectors:[["app-edit-student"]],inputs:{member:"member"},outputs:{close:"close"},standalone:!0,features:[e.aNF],decls:103,vars:26,consts:[["slot","end"],["color","dark",3,"click"],["name","close-outline"],["color","primary",3,"fullscreen"],["lines","none",1,"ion-margin","pic"],["slot","end",3,"click"],[3,"src"],[3,"formGroup"],[1,"form-row"],["sizeLg","6","sizeMd","6","sizeSm","12","sizeXl","6","sizeXs","12"],["lines","none"],["labelPlacement","start","formControlName","status"],[1,"col-input"],["label","ID No.","labelPlacement","floating","type","number","formControlName","serial_no","errorText","* Please serial no."],["label","NAME","labelPlacement","floating","type","text","formControlName","name","errorText","* Please enter proper name."],["label","EMAIL","labelPlacement","floating","formControlName","email","type","email",3,"errorText"],["label","PHONE","labelPlacement","floating","formControlName","phone","type","number",3,"errorText"],["lines","none","color","primary"],["slot","end","datetime","datetime"],[3,"keepContentsMounted"],["label","GENDER","labelPlacement","fixed","formControlName","gender","interface","popover","placeholder","Select Gender"],["value","M"],["value","F"],["value","T"],[1,"error"],["label","WEIGHT","labelPlacement","floating","formControlName","weight","type","number","placeholder","Enter weight","errorText","* Please provide your current body weight"],["formControlName","feet","label","HEIGHT","labelPlacement","stacked",3,"min","max","step","value","pin","ticks","snaps"],["slot","start"],["formControlName","inches","label","","labelPlacement","stacked",3,"min","max","step","value","pin","ticks","snaps"],["label","ADDRESS","labelPlacement","floating","rows","1","formControlName","address","errorText","* Please provide your address",3,"autoGrow"],["label","MEMBERSHIP TYPE","labelPlacement","stacked","formControlName","membership_type","placeholder","Select type","interface","popover"],["value","Monthly"],["value","Quarterly"],["value","Half-yearly"],["value","Yearly"],["mode","md"],[1,"ion-margin"],["label","NAME","labelPlacement","floating","type","text","formControlName","guardian_name","errorText","* Please enter proper name."],["label","PHONE","labelPlacement","floating","formControlName","guardian_phone","type","number",3,"errorText"],["label","RELATION","labelPlacement","floating","type","text","formControlName","guardian_relation","errorText","* Please enter your relation"],["expand","block","color","tertiary","size","large"],["expand","block","size","large","color","tertiary"],["id","datetime","presentation","date","formControlName","dob",3,"showDefaultButtons"],["expand","block","color","tertiary","size","large",3,"click"],["name","crescent","color","light"]],template:function(k,o){1&k&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Edit Member"),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return o.dismiss()}),e.nrm(6,"ion-icon",2),e.k0s()()()(),e.j41(7,"ion-content",3)(8,"ion-item",4)(9,"ion-label"),e.EFF(10," Take a selfie or select picture "),e.j41(11,"p"),e.EFF(12,"To update your photo"),e.k0s()(),e.j41(13,"ion-thumbnail",5),e.bIt("click",function(){return o.takePicture()}),e.nrm(14,"ion-img",6),e.k0s()(),e.j41(15,"form",7)(16,"ion-row",8)(17,"ion-col",9)(18,"ion-item",10)(19,"ion-toggle",11),e.EFF(20,"Status"),e.k0s()()(),e.j41(21,"ion-col",9)(22,"div",12),e.nrm(23,"ion-input",13),e.k0s()(),e.j41(24,"ion-col",9)(25,"div",12),e.nrm(26,"ion-input",14),e.k0s()(),e.j41(27,"ion-col",9)(28,"div",12),e.nrm(29,"ion-input",15),e.k0s()(),e.j41(30,"ion-col",9)(31,"div",12),e.nrm(32,"ion-input",16),e.k0s()(),e.j41(33,"ion-col",9)(34,"ion-item",17)(35,"ion-label"),e.EFF(36,"Date of Birth"),e.k0s(),e.nrm(37,"ion-datetime-button",18),e.j41(38,"ion-modal",19),e.DNE(39,M,1,1,"ng-template"),e.k0s()()(),e.j41(40,"ion-col",9)(41,"div",12)(42,"ion-select",20)(43,"ion-select-option",21),e.EFF(44,"Male"),e.k0s(),e.j41(45,"ion-select-option",22),e.EFF(46,"Female"),e.k0s(),e.j41(47,"ion-select-option",23),e.EFF(48,"Transgender"),e.k0s()(),e.DNE(49,_,2,0,"div",24),e.k0s()(),e.j41(50,"ion-col",9)(51,"div",12)(52,"ion-input",25)(53,"div",0),e.EFF(54,"kgs"),e.k0s()()()(),e.j41(55,"ion-col",9)(56,"div",12)(57,"ion-range",26)(58,"div",27),e.EFF(59,"3"),e.k0s(),e.j41(60,"div",0),e.EFF(61,"8"),e.k0s(),e.j41(62,"div",0),e.EFF(63,"feet"),e.k0s()(),e.j41(64,"ion-range",28)(65,"div",27),e.EFF(66,"0"),e.k0s(),e.j41(67,"div",0),e.EFF(68,"12"),e.k0s(),e.j41(69,"div",0),e.EFF(70,"inch"),e.k0s()(),e.DNE(71,d,2,0,"div",24),e.k0s()(),e.j41(72,"ion-col",9)(73,"div",12),e.nrm(74,"ion-textarea",29),e.k0s()(),e.j41(75,"ion-col",9)(76,"div",12)(77,"ion-select",30)(78,"ion-select-option",31),e.EFF(79,"Monthly"),e.k0s(),e.j41(80,"ion-select-option",32),e.EFF(81,"Quarterly"),e.k0s(),e.j41(82,"ion-select-option",33),e.EFF(83,"Half-yearly"),e.k0s(),e.j41(84,"ion-select-option",34),e.EFF(85,"Yearly"),e.k0s()(),e.DNE(86,v,2,0,"div",24),e.k0s()()(),e.j41(87,"ion-item-divider",35)(88,"ion-label"),e.EFF(89,"GUARDIAN/EMERGENCY CONTACT"),e.k0s()(),e.j41(90,"ion-row",36)(91,"ion-col",9)(92,"div",12),e.nrm(93,"ion-input",37),e.k0s()(),e.j41(94,"ion-col",9)(95,"div",12),e.nrm(96,"ion-input",38),e.k0s()(),e.j41(97,"ion-col",9)(98,"div",12),e.nrm(99,"ion-input",39),e.k0s()()()(),e.j41(100,"div",36),e.DNE(101,u,3,0,"ion-button",40)(102,m,2,0,"ion-button",41),e.k0s()()),2&k&&(e.R7$(7),e.Y8G("fullscreen",!0),e.R7$(7),e.Y8G("src",o.photo?"data:image/png;base64,"+o.photo.base64String:"assets/imgs/avatar.png"),e.R7$(),e.Y8G("formGroup",o.form),e.R7$(14),e.Y8G("errorText",o.form.get("email").hasError("email")?"* Please enter proper email address.":"* Please enter your Email Address"),e.R7$(3),e.Y8G("errorText",o.form.get("phone").hasError("minlength")||o.form.get("phone").hasError("maxlength")?"* Please enter your 10 digits Phone number.":"* Please enter your Phone number"),e.R7$(6),e.Y8G("keepContentsMounted",!0),e.R7$(11),e.vxM(o.form.get("gender").touched&&o.form.get("gender").hasError("required")?49:-1),e.R7$(8),e.Y8G("min",3)("max",8)("step",1)("value",5)("pin",!0)("ticks",!0)("snaps",!0),e.R7$(7),e.Y8G("min",0)("max",12)("step",1)("value",0)("pin",!0)("ticks",!0)("snaps",!0),e.R7$(7),e.vxM(o.form.get("feet").touched&&o.form.get("feet").hasError("required")||o.form.get("inches").touched&&o.form.get("inches").hasError("required")?71:-1),e.R7$(3),e.Y8G("autoGrow",!0),e.R7$(12),e.vxM(o.form.get("membership_type").touched&&o.form.get("membership_type").hasError("required")?86:-1),e.R7$(10),e.Y8G("errorText",o.form.get("guardian_phone").hasError("minlength")||o.form.get("guardian_phone").hasError("maxlength")?"* Please enter your 10 digits Emergency Phone number.":"* Please enter your Emergency Phone number"),e.R7$(5),e.vxM(o.isSave?102:101))},dependencies:[C.BY,C.w2,C.IO,C.KW,C.uz,C.K4,C.he,C.A9,C.Sb,C.Ob,C.nc,C.ln,C.Dg,C.$w,C.hU,C.QW,C.Jm,C.iq,C.W9,C.BC,C.ai,C.eU,C.Nm,C.Ip,C.Zx,r.X1,r.qT,r.BC,r.cb,r.j4,r.JD],styles:["ion-button[size=large][_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:1rem}"]}),j})();var s=h(8809),n=h(5109),a=h(9897),i=h(2109),l=h(7213),y=h(8509),c=h(1929),E=h(5079),f=h(5873);const P=S=>["/","tabs","students",S,"plan-history"],g=()=>[0,.5,.9,1];function R(S,j){1&S&&(e.j41(0,"ion-text",18),e.EFF(1,"Expired"),e.k0s())}function F(S,j){1&S&&e.EFF(0," Expiry ")}function O(S,j){if(1&S&&(e.j41(0,"ion-text",17),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&S){const D=e.XpG();e.R7$(),e.SpI(" ",e.i5U(2,1,null==D.member||null==D.member.gym_plan?null:D.member.gym_plan.expiry_date,"MMM d, y")," ")}}function I(S,j){1&S&&(e.j41(0,"ion-text",17),e.EFF(1," - "),e.k0s())}function V(S,j){1&S&&(e.j41(0,"ion-text",18),e.EFF(1,"Expired"),e.k0s())}function N(S,j){1&S&&e.EFF(0," Expiry ")}function z(S,j){if(1&S&&(e.j41(0,"ion-text",17),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&S){const D=e.XpG();e.R7$(),e.SpI(" ",e.i5U(2,1,null==D.member||null==D.member.pt_plan?null:D.member.pt_plan.expiry_date,"MMM d, y")," ")}}function ne(S,j){1&S&&(e.j41(0,"ion-text",17),e.EFF(1," - "),e.k0s())}function ie(S,j){if(1&S&&(e.j41(0,"ion-text",17),e.EFF(1),e.k0s()),2&S){const D=e.XpG(2);e.R7$(),e.Lme(" ",null==D.member||null==D.member.pt_plan?null:D.member.pt_plan.sessions_used," / ",null==D.member||null==D.member.pt_plan?null:D.member.pt_plan.sessions," ")}}function oe(S,j){1&S&&(e.j41(0,"ion-text",17),e.EFF(1," - "),e.k0s())}function le(S,j){if(1&S&&(e.j41(0,"ion-col",15)(1,"div",16)(2,"ion-label"),e.EFF(3,"PT Sessions Used"),e.k0s(),e.j41(4,"p"),e.DNE(5,ie,2,2,"ion-text",17)(6,oe,2,0,"ion-text",17),e.k0s()()()),2&S){const D=e.XpG();e.R7$(5),e.vxM(null!=D.member&&D.member.pt_plan?5:6)}}function se(S,j){if(1&S){const D=e.RV6();e.j41(0,"ion-col")(1,"ion-button",34),e.bIt("click",function(){e.eBV(D);const o=e.XpG(2);return e.Njj(o.global.mail(null==o.member?null:o.member.email))}),e.nrm(2,"ion-icon",35),e.k0s()()}}function ae(S,j){if(1&S){const D=e.RV6();e.j41(0,"ion-row",19)(1,"ion-col")(2,"ion-button",31),e.bIt("click",function(){e.eBV(D);const o=e.XpG();return e.Njj(o.global.call(null==o.member?null:o.member.phone))}),e.nrm(3,"ion-icon",28),e.k0s()(),e.j41(4,"ion-col")(5,"ion-button",32),e.bIt("click",function(){e.eBV(D);const o=e.XpG();return e.Njj(o.whatsapp(o.member))}),e.nrm(6,"ion-icon",33),e.k0s()(),e.DNE(7,se,3,0,"ion-col"),e.k0s()}if(2&S){const D=e.XpG();e.R7$(7),e.vxM(null!=D.member&&D.member.email?7:-1)}}function re(S,j){if(1&S){const D=e.RV6();e.j41(0,"ion-col",21)(1,"ion-button",36),e.bIt("click",function(){e.eBV(D);const o=e.XpG(2);return e.Njj(o.bookSession())}),e.nrm(2,"ion-icon",38),e.j41(3,"ion-text",24),e.EFF(4,"BOOK SESSION"),e.k0s()()()}2&S&&(e.R7$(),e.Y8G("strong",!0))}function ue(S,j){if(1&S){const D=e.RV6();e.j41(0,"ion-col",21)(1,"ion-button",36),e.bIt("click",function(){e.eBV(D);const o=e.XpG();return e.Njj(o.isRenew=!0)}),e.nrm(2,"ion-icon",37),e.j41(3,"ion-text",24),e.EFF(4,"RENEW PLAN"),e.k0s()()(),e.j41(5,"ion-col",21)(6,"ion-button",36),e.bIt("click",function(){e.eBV(D);const o=e.XpG();return e.Njj(o.isPt=!0)}),e.nrm(7,"ion-icon",38),e.j41(8,"ion-text",24),e.EFF(9,"PT PLAN"),e.k0s()()(),e.DNE(10,re,5,1,"ion-col",21)}if(2&S){const D=e.XpG();e.R7$(),e.Y8G("strong",!0),e.R7$(5),e.Y8G("strong",!0),e.R7$(4),e.vxM(null!=D.member&&D.member.pt_plan&&D.currentDate<=(null==D.member||null==D.member.pt_plan?null:D.member.pt_plan.expiry_date)&&(null==D.member||null==D.member.pt_plan?null:D.member.pt_plan.sessions)-(null==D.member||null==D.member.pt_plan?null:D.member.pt_plan.sessions_used)>0?10:-1)}}function ce(S,j){if(1&S){const D=e.RV6();e.j41(0,"app-edit-student",39),e.bIt("close",function(o){e.eBV(D);const A=e.XpG(),G=e.sdS(103);return e.Njj(A.updateMemberModalDismiss(o,G))}),e.k0s()}if(2&S){const D=e.XpG();e.Y8G("member",D.member)}}function de(S,j){if(1&S){const D=e.RV6();e.j41(0,"app-renew-package",39),e.bIt("close",function(o){e.eBV(D);const A=e.XpG(),G=e.sdS(106);return e.Njj(A.renewalModalDismiss(o,G))}),e.k0s()}if(2&S){const D=e.XpG();e.Y8G("member",D.member)}}function me(S,j){if(1&S){const D=e.RV6();e.j41(0,"app-renew-pt-package",39),e.bIt("close",function(o){e.eBV(D);const A=e.XpG(),G=e.sdS(109);return e.Njj(A.renewalPtModalDismiss(o,G))}),e.k0s()}if(2&S){const D=e.XpG();e.Y8G("member",D.member)}}function pe(S,j){if(1&S){const D=e.RV6();e.j41(0,"app-add-pt-session",40),e.bIt("close",function(o){e.eBV(D);const A=e.XpG(),G=e.sdS(112);return e.Njj(A.addPtSessionModalDismiss(o,G))}),e.k0s()}if(2&S){const D=e.XpG();e.Y8G("member",D.member)("allTrainers",D.trainers)("batches",D.batches)}}const _e=[{path:"",component:(()=>{var S;class j{constructor(){this.isEdit=!1,this.isRenew=!1,this.isPt=!1,this.isBookSession=!1,this.currentDate=(new Date).toISOString(),this.trainers=[],this.batches=[],this.profileService=(0,e.WQX)(y.p),this.route=(0,e.WQX)(b.nX),this.navCtrl=(0,e.WQX)(w.q9),this.customerService=(0,e.WQX)(B.m),this.global=(0,e.WQX)($.d),this.trainerService=(0,e.WQX)(i.j),this.batchService=(0,e.WQX)(l.k),this.socialSharing=(0,e.WQX)(c.s),(0,E.a)({syncOutline:f.E97,add:f.WQq,createOutline:f.hmR,call:f.T1z,mail:f.kiB,eyeOutline:f.ov$,logoWhatsapp:f.qud,arrowBack:f.$$C,trashOutline:f.P1A})}ngOnInit(){const k=this.route.snapshot.paramMap.get("id");k||this.navCtrl.back(),this.id=k,this.getMember(),this.memberSub=this.customerService.member.subscribe({next:o=>{this.member=o,console.log(this.member)}}),this.getProfile()}getMember(){var k=this;return(0,T.A)(function*(){try{yield k.customerService.getStudent(k.id)}catch(o){console.log(o),k.global.checkMessageForErrorToast(o)}})()}getProfile(){var k=this;return(0,T.A)(function*(){k.profileSub=k.profileService.profile.subscribe({next:o=>{k.profile=o}});try{yield k.profileService.getProfile()}catch(o){console.log(o)}})()}bookSession(){var k=this;return(0,T.A)(function*(){try{var o;0==(null===(o=k.trainers)||void 0===o?void 0:o.length)&&(k.batches=yield k.batchService.getAllBatches(),k.trainers=yield k.trainerService.getAllTrainers(),console.log(k.trainers)),k.isBookSession=!0}catch(A){console.log(A),k.global.checkMessageForErrorToast(A)}})()}updateMemberModalDismiss(k,o){o.dismiss()}renewalModalDismiss(k,o){o.dismiss()}renewalPtModalDismiss(k,o){o.dismiss()}addPtSessionModalDismiss(k,o){console.log(k),k&&(this.member.pt_plan.sessions_used+=1),o.dismiss()}whatsapp(k){var o=this;return(0,T.A)(function*(){try{if(1==o.global.checkPlatform())return;yield o.socialSharing.shareViaWhatsAppToPhone("+91"+(null==k?void 0:k.phone),"",null)}catch(A){console.log(A),o.global.checkMessageForErrorToast(A)}})()}ngOnDestroy(){this.memberSub&&this.memberSub.unsubscribe(),this.customerService.resetMember(),this.profileSub&&this.profileSub.unsubscribe()}}return(S=j).\u0275fac=function(k){return new(k||S)},S.\u0275cmp=e.VBU({type:S,selectors:[["app-student-detail"]],standalone:!0,features:[e.aNF],decls:114,vars:43,consts:[["edit_modal",""],["renew_modal",""],["renew_pt_modal",""],["book_session_modal",""],["slot","start"],["defaultHref","/tabs/students"],["slot","end"],["color","tertiary",3,"click"],["name","create-outline"],["color","light"],["lines","full"],[3,"src"],["color","medium"],["slot","end",3,"color"],[1,"ion-margin-top","details"],["size","4"],["align","center"],["color","dark"],["color","danger"],[1,"ion-text-center","ion-margin","buttons"],[1,"ion-padding","plans"],["size","6"],["color","light","expand","block","size","small",3,"strong","routerLink"],["slot","start","name","eye-outline"],["color","tertiary"],[1,"header-color"],["lines","none"],["slot","end","fill","outline","color","success",3,"click"],["name","call"],[3,"didDismiss","isOpen","breakpoints","initialBreakpoint"],[3,"didDismiss","isOpen"],["color","primary","size","small","fill","outline",3,"click"],["color","success","size","small","fill","outline",3,"click"],["name","logo-whatsapp"],["color","warning","size","small","fill","outline",3,"click"],["name","mail"],["color","light","expand","block","size","small",3,"click","strong"],["slot","start","name","sync-outline"],["slot","start","name","add"],[3,"close","member"],[3,"close","member","allTrainers","batches"]],template:function(k,o){if(1&k){const A=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Member detail"),e.k0s(),e.j41(4,"ion-buttons",4),e.nrm(5,"ion-back-button",5),e.k0s(),e.j41(6,"ion-buttons",6)(7,"ion-button",7),e.bIt("click",function(){return e.eBV(A),e.Njj(o.isEdit=!0)}),e.nrm(8,"ion-icon",8),e.k0s()()()(),e.j41(9,"ion-content",9)(10,"ion-card")(11,"ion-item",10)(12,"ion-thumbnail",4),e.nrm(13,"ion-img",11),e.k0s(),e.j41(14,"ion-label"),e.EFF(15),e.j41(16,"p")(17,"ion-text",12),e.EFF(18),e.k0s()(),e.j41(19,"p"),e.EFF(20),e.k0s(),e.j41(21,"p"),e.EFF(22),e.nI1(23,"timestampToDate"),e.nI1(24,"date"),e.k0s()(),e.j41(25,"ion-text",13),e.EFF(26),e.k0s()(),e.j41(27,"ion-row",14)(28,"ion-col",15)(29,"div",16)(30,"ion-label"),e.EFF(31,"Gender"),e.k0s(),e.j41(32,"p")(33,"ion-text",17),e.EFF(34),e.k0s()()()(),e.j41(35,"ion-col",15)(36,"div",16)(37,"ion-label"),e.EFF(38,"Height"),e.k0s(),e.j41(39,"p")(40,"ion-text",17),e.EFF(41),e.k0s()()()(),e.j41(42,"ion-col",15)(43,"div",16)(44,"ion-label"),e.EFF(45,"Weight"),e.k0s(),e.j41(46,"p")(47,"ion-text",17),e.EFF(48),e.k0s()()()(),e.j41(49,"ion-col",15)(50,"div",16)(51,"ion-label"),e.EFF(52,"DOB"),e.k0s(),e.j41(53,"p")(54,"ion-text",17),e.EFF(55),e.nI1(56,"timestampToDate"),e.nI1(57,"date"),e.k0s()()()(),e.j41(58,"ion-col",15)(59,"div",16)(60,"ion-label"),e.EFF(61,"Membership"),e.k0s(),e.j41(62,"p")(63,"ion-text",17),e.EFF(64),e.k0s()()()(),e.j41(65,"ion-col",15)(66,"div",16)(67,"ion-label"),e.EFF(68," Plan "),e.DNE(69,R,2,0,"ion-text",18)(70,F,1,0),e.k0s(),e.j41(71,"p"),e.DNE(72,O,3,4,"ion-text",17)(73,I,2,0,"ion-text",17),e.k0s()()(),e.j41(74,"ion-col",15)(75,"div",16)(76,"ion-label"),e.EFF(77," PT Plan "),e.DNE(78,V,2,0,"ion-text",18)(79,N,1,0),e.k0s(),e.j41(80,"p"),e.DNE(81,z,3,4,"ion-text",17)(82,ne,2,0,"ion-text",17),e.k0s()()(),e.DNE(83,le,7,1,"ion-col",15),e.k0s(),e.DNE(84,ae,8,1,"ion-row",19),e.j41(85,"ion-row",20),e.DNE(86,ue,11,3),e.j41(87,"ion-col",21)(88,"ion-button",22),e.nrm(89,"ion-icon",23),e.j41(90,"ion-text",24),e.EFF(91,"PLANS HISTORY"),e.k0s()()()()(),e.j41(92,"ion-list-header",25),e.EFF(93," Guardian details "),e.k0s(),e.j41(94,"ion-card")(95,"ion-item",26)(96,"ion-label"),e.EFF(97),e.j41(98,"p"),e.EFF(99),e.k0s()(),e.j41(100,"ion-button",27),e.bIt("click",function(){return e.eBV(A),e.Njj(o.global.call(null==o.member?null:o.member.guardian_phone))}),e.nrm(101,"ion-icon",28),e.k0s()()(),e.j41(102,"ion-modal",29,0),e.bIt("didDismiss",function(){return e.eBV(A),e.Njj(o.isEdit=!1)}),e.DNE(104,ce,1,1,"ng-template"),e.k0s(),e.j41(105,"ion-modal",30,1),e.bIt("didDismiss",function(){return e.eBV(A),e.Njj(o.isRenew=!1)}),e.DNE(107,de,1,1,"ng-template"),e.k0s(),e.j41(108,"ion-modal",30,2),e.bIt("didDismiss",function(){return e.eBV(A),e.Njj(o.isPt=!1)}),e.DNE(110,me,1,1,"ng-template"),e.k0s(),e.j41(111,"ion-modal",30,3),e.bIt("didDismiss",function(){return e.eBV(A),e.Njj(o.isBookSession=!1)}),e.DNE(113,pe,1,3,"ng-template"),e.k0s()()}2&k&&(e.R7$(13),e.Y8G("src",null==o.member?null:o.member.photo),e.R7$(2),e.SpI(" ",(null==o.member?null:o.member.name)+" ("+(null==o.member?null:o.member.serial_no)+")"," "),e.R7$(3),e.JRh(null==o.member?null:o.member.phone),e.R7$(2),e.JRh(null==o.member?null:o.member.address),e.R7$(2),e.SpI(" Joined on ",e.i5U(24,32,e.bMT(23,30,null==o.member?null:o.member.created_at),"MMM d, y")," "),e.R7$(3),e.Y8G("color",null!=o.member&&o.member.status?"success":"danger"),e.R7$(),e.SpI(" ",null!=o.member&&o.member.status?"ACTIVE":"INACTIVE"," "),e.R7$(8),e.JRh(null==o.member?null:o.member.gender),e.R7$(7),e.Lme("",null==o.member?null:o.member.feet,'" ',null==o.member?null:o.member.inches,"'"),e.R7$(7),e.SpI("",null==o.member?null:o.member.weight," kg"),e.R7$(7),e.JRh(e.i5U(57,37,e.bMT(56,35,null==o.member?null:o.member.dob),"MMM d, y")),e.R7$(9),e.JRh(null==o.member?null:o.member.membership_type),e.R7$(5),e.vxM(null!=o.member&&o.member.gym_plan&&o.currentDate>(null==o.member||null==o.member.gym_plan?null:o.member.gym_plan.expiry_date)?69:70),e.R7$(3),e.vxM(null!=o.member&&o.member.gym_plan?72:73),e.R7$(6),e.vxM(null!=o.member&&o.member.pt_plan&&o.currentDate>(null==o.member||null==o.member.pt_plan?null:o.member.pt_plan.expiry_date)?78:79),e.R7$(3),e.vxM(null!=o.member&&o.member.pt_plan?81:82),e.R7$(2),e.vxM(null!=o.member&&o.member.pt_plan?83:-1),e.R7$(),e.vxM("admin"==(null==o.profile?null:o.profile.type)?84:-1),e.R7$(2),e.vxM(null!=o.member&&o.member.status?86:-1),e.R7$(2),e.Y8G("strong",!0)("routerLink",e.eq3(40,P,null==o.member?null:o.member.id)),e.R7$(9),e.SpI(" ",null==o.member?null:o.member.guardian_name," "),e.R7$(2),e.JRh(null==o.member?null:o.member.guardian_relation),e.R7$(3),e.Y8G("isOpen",o.isEdit)("breakpoints",e.lJ4(42,g))("initialBreakpoint",.9),e.R7$(3),e.Y8G("isOpen",o.isRenew),e.R7$(3),e.Y8G("isOpen",o.isPt),e.R7$(3),e.Y8G("isOpen",o.isBookSession))},dependencies:[C.Sb,C.AF,C.iq,C.Jm,C.KW,C.uz,C.b_,C.ln,C.he,C.IO,C.hU,C.el,C.QW,C.W9,C.eU,C.BC,C.ai,C.Zx,t.vh,b.Wk,x.i,p,s.X,n.X,a.j],styles:["ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;margin-top:5px;font-weight:400}ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.9rem}ion-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:4rem;height:4rem}ion-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{height:100%;width:100%;border-radius:8px}ion-row.details[_ngcontent-%COMP%]{border-bottom:1px solid lightgray}ion-row.details[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{margin:10px 0}ion-row.details[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.8rem;color:gray}ion-row.details[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:.9rem}.buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 20px}ion-list-header[_ngcontent-%COMP%]{font-size:1rem}.plans[_ngcontent-%COMP%]{border-top:5px solid var(--ion-color-light)}"]}),j})()},{path:"plan-history",loadComponent:()=>h.e(448).then(h.bind(h,6448)).then(S=>S.PlanHistoryPage)}]},9685:(U,W,h)=>{h.d(W,{i:()=>t});var T=h(3953);let t=(()=>{var e;class b{transform(C){return C?null!=C&&C.seconds?new Date(1e3*(C.seconds||0)+(C.nanoseconds||0)/1e6):C:null}}return(e=b).\u0275fac=function(C){return new(C||e)},e.\u0275pipe=T.EJ8({name:"timestampToDate",type:e,pure:!0,standalone:!0}),b})()},1583:(U,W,h)=>{h.d(W,{m:()=>B});var T=h(467),t=h(9642),e=h(3953),b=h(9967),w=h(4412),C=h(1985),x=h(1339);let B=(()=>{var $;class r{get registerForm(){return this._registerForm.asObservable()}get students(){return this._students.asObservable()}get member(){return this._member.asObservable()}constructor(){this.expiry_days_count=365,this._registerForm=new w.t(0),this._students=new w.t([]),this._member=new w.t(null),this.apiService=(0,e.WQX)(t.G),this.auth=(0,e.WQX)(x.u)}updateFormValue(_){this._registerForm.next(_)}uploadPhoto(_,d){var v=this;return(0,T.A)(function*(){try{const u=Date.now();console.log(d);const m=`students/${u}.${_.format}`;return yield v.apiService.uploadImage(d,m)}catch(u){throw u}})()}registerStudent(_,d,v){var u=this;return(0,T.A)(function*(){try{const m=u.apiService.collectionFirestoreRef("students"),p=(0,b.P)(m,(0,b.or)(u.apiService.whereQuery("email","==",null==_?void 0:_.email),u.apiService.whereQuery("phone","==",null==_?void 0:_.phone))),n=yield(yield u.apiService.getDocsByQuery(p)).docs.map(c=>c.data());if((null==n?void 0:n.length)>0)throw{code:"exists",message:"Student already registered with same email or phone number"};const a=yield u.uploadPhoto(d,v),i={..._,photo:a},l=yield u.apiService.addDocument("students",i);let y=[{...i,id:null==l?void 0:l.id},...u._students.value];return u._students.next(y),l}catch(m){throw m}})()}getStudents(_,d,v){var u=this;return(0,T.A)(function*(){try{if(!(yield u.auth.getId()))throw"Unauthorized user";v||(u.lastVisible=null);const p=u.apiService.collectionFirestoreRef("students");let s=(0,b.P)(p,u.apiService.orderByQuery("created_at","desc"),u.apiService.limitQuery(_));d&&(s=(0,b.P)(s,u.apiService.whereQuery("short_name",">=",d),u.apiService.whereQuery("short_name","<=",d+"\uf8ff"))),u.lastVisible&&v&&(s=(0,b.P)(s,u.apiService.startAfterQuery(u.lastVisible)));const n=yield u.apiService.getDocsByQuery(s);console.log(n);let a=[];n.docs.length>0&&(u.lastVisible=n.docs[n.docs.length-1],console.log("last",u.lastVisible),a=yield n.docs.map(l=>{let y=l.data();return y.id=l.id,y}));let i=[];return v?(console.log("orders",a),i=u._students.value||[],i=i.concat(a)):i=[...a],u._students.next(i),i}catch(m){throw m}})()}getStudentsCount(){var _=this;return(0,T.A)(function*(){try{return(yield _.apiService.getDocs("students")).size}catch(d){throw d}})()}getStudent(_){var d=this;return(0,T.A)(function*(){try{const v=yield d.apiService.getDocById(`students/${_}`);if(v.exists()){let u=v.data();return u.id=v.id,d._member.next(u),u}throw console.log("No such document!"),"No such document!"}catch(v){throw v}})()}updateMember(_,d,v,u){var m=this;return(0,T.A)(function*(){try{if(v){const a=yield m.uploadPhoto(v,u);d={...d,photo:a}}const p=yield m.apiService.updateDocument(`students/${_.id}`,d);console.log(p);let s=m._students.value||[];if(0==(null==s?void 0:s.length)){let a=m._member.value;return console.log("member data: ",a),a?(a={...a,...d},m._member.next(a),{...a,...d}):null}const n=s.findIndex(a=>a.id==_.id);return-1==n?null:(s[n]={...s[n],...d},m._students.next(s),m._member.next(s[n]),{...s[n]})}catch(p){throw p}})()}updateMemberValue(_,d=!0){const v=this._students.value;let u;if((null==v?void 0:v.length)>0){const m=v.findIndex(p=>p.id==(null==_?void 0:_.id));if(-1==m)return;v[m]={...v[m],..._},this._students.next(v),u=v[m]}else{if(u=this._member.value,!u)return;u={...u,..._}}d&&this._member.next(u)}updateMemberData(_,d){const v=this._students.value;let u;if(0==(null==v?void 0:v.length)){if(u=this._member.value,!u)return}else u=v.find(p=>p.id==_);const m={...u,...d};this._member.next(m),this.updateMemberValue(m,!1)}resetMember(){this._member.next(null)}getMemberData(_){var d=this;return(0,T.A)(function*(){try{let v=d._member.value;return v||(v=yield d.getStudent(_)),v}catch(v){throw v}})()}fetchMembersWithExpiringPlans(){return new C.c(_=>{const d=(new Date).toISOString(),v=new Date;v.setDate(v.getDate()+this.expiry_days_count);const u=v.toISOString(),m=this.apiService.collectionFirestoreRef("students"),p=(0,b.P)(m,this.apiService.whereQuery("gym_plan.expiry_date","<=",u),this.apiService.whereQuery("pt_plan.expiry_date","<=",u));return(0,b.aQ)(p,n=>{const a=[];n.docs.forEach(i=>{const l=i.data(),y=i.id,c=[];null!=l&&l.gym_plan&&l.gym_plan.expiry_date>=d&&l.gym_plan.expiry_date<=u&&c.push("GYM"),null!=l&&l.pt_plan&&(l.pt_plan.expiry_date>=d&&l.pt_plan.expiry_date<=u||l.pt_plan.sessions-l.pt_plan.sessions_used==0)&&c.push("PT"),c.length>0&&a.push({id:y,...l,expiringPlans:c})}),console.log(a),_.next(a)},n=>_.error(n))})}fetchMembersWithExpiredGymPlans(){var _=this;return(0,T.A)(function*(){try{const d=(new Date).toISOString(),v=_.apiService.collectionFirestoreRef("students"),u=(0,b.P)(v,_.apiService.whereQuery("gym_plan.expiry_date","<",d)),m=yield _.apiService.getDocsByQuery(u),p=[];return m.forEach(s=>{const n=s.data();p.push({id:s.id,...n})}),console.log(p),p}catch(d){throw console.error(d),d}})()}fetchMembersWithExpiredOrUsedUpPTPlans(){var _=this;return(0,T.A)(function*(){try{const d=(new Date).toISOString(),v=_.apiService.collectionFirestoreRef("students"),u=(0,b.P)(v,_.apiService.whereQuery("pt_plan.expiry_date","<=",d),_.apiService.whereQuery("pt_plan.sessions",">=",0)),m=yield _.apiService.getDocsByQuery(u),p=[];return m.forEach(s=>{var n,a,i;const l=s.data();(null==l?void 0:l.pt_plan)&&((null==l||null===(n=l.pt_plan)||void 0===n?void 0:n.expiry_date)<=d||(null==l||null===(a=l.pt_plan)||void 0===a?void 0:a.sessions)-(null==l||null===(i=l.pt_plan)||void 0===i?void 0:i.sessions_used)==0)&&p.push({id:s.id,...l})}),console.log(p),p}catch(d){throw console.error(d),d}})()}getDaysLeft(_){const d=new Date(_),v=new Date;d.setHours(0,0,0,0),v.setHours(0,0,0,0);const u=new Date;if(u.setDate(v.getDate()+this.expiry_days_count),v<=d&&d<=u){const m=d.getTime()-v.getTime();return Math.ceil(m/864e5)}return null}}return($=r).\u0275fac=function(_){return new(_||$)},$.\u0275prov=e.jDH({token:$,factory:$.\u0275fac,providedIn:"root"}),r})()},3979:(U,W,h)=>{h.d(W,{v:()=>C});var T=h(467),t=h(3953),e=h(9642),b=h(9967),w=h(4412);let C=(()=>{var x;class B{get sessions(){return this._sessions.asObservable()}constructor(){this._sessions=new w.t([]),this.apiService=(0,t.WQX)(e.G)}addSession(r,M,_){var d=this;return(0,T.A)(function*(){try{var v;const p=new Date;_={..._,member:null==r?void 0:r.id,pt_plan:M,created_at:p,updated_at:p};const s=yield d.apiService.addDocument(`renewals/${M}/sessions`,_);var u,m;return null!==(v=_)&&void 0!==v&&v.end_time&&(yield d.apiService.updateDocument(`students/${null==r?void 0:r.id}`,{pt_plan:{...null==r?void 0:r.pt_plan,sessions_used:+(null==r||null===(u=r.pt_plan)||void 0===u?void 0:u.sessions_used)+1}}),yield d.apiService.updateDocument(`renewals/${M}`,{pt_sessions_used:+(null==r||null===(m=r.pt_plan)||void 0===m?void 0:m.sessions_used)+1})),s}catch(p){throw p}})()}updateSession(r,M,_,d){var v=this;return(0,T.A)(function*(){try{_={...M,..._,updated_at:new Date};const m=yield v.apiService.updateDocument(`renewals/${r}/sessions/${null==M?void 0:M.id}`,_);let p=[...v._sessions.value];const s=p.findIndex(n=>n.id==M.id);return s>=0&&(p[s]={..._,trainer:d},v._sessions.next(p)),m}catch(u){throw u}})()}getSessions(r,M,_){var d=this;return(0,T.A)(function*(){try{const v=d.apiService.collectionFirestoreRef(`renewals/${r}/sessions`);let u=(0,b.P)(v,d.apiService.orderByQuery("session_no","desc"),d.apiService.limitQuery(M));d.lastVisible&&_&&(u=(0,b.P)(u,d.apiService.startAfterQuery(d.lastVisible)));const m=yield d.apiService.getDocsByQuery(u);d.lastVisible=m.docs[m.docs.length-1];const p=yield Promise.all(m.docs.map(function(){var n=(0,T.A)(function*(a){const i={...a.data(),id:a.id};if(null!=i&&i.trainer){const l=yield d.apiService.getDocById(`users/${i.trainer}`);l.exists()&&(i.trainer={...l.data(),id:l.id})}return i});return function(a){return n.apply(this,arguments)}}())),s=[...d._sessions.value,...p];return d._sessions.next(s),p}catch(v){throw console.error("Error fetching sessions:",v),v}})()}reset(){this._sessions.next([]),this.lastVisible=null}}return(x=B).\u0275fac=function(r){return new(r||x)},x.\u0275prov=t.jDH({token:x,factory:x.\u0275fac,providedIn:"root"}),B})()},3917:(U,W,h)=>{h.d(W,{L:()=>C});var T=h(467),t=h(3953),e=h(9642),b=h(4412),w=h(9967);let C=(()=>{var x;class B{get renewals(){return this._renewals.asObservable()}constructor(){this._renewals=new b.t([]),this.apiService=(0,t.WQX)(e.G)}getGymPlans(){var r=this;return(0,T.A)(function*(){try{const _=yield(yield r.apiService.getDocs("gym_fee_packages")).docs.map(d=>{let v=d.data();return v.id=d.id,v});return console.log("packages",_),_}catch(M){throw M}})()}getPTPackages(){var r=this;return(0,T.A)(function*(){try{const _=yield(yield r.apiService.getDocs("pt_packages")).docs.map(d=>{let v=d.data();return v.id=d.id,v});return console.log("packages",_),_}catch(M){throw M}})()}getPTCategories(){var r=this;return(0,T.A)(function*(){try{const _=yield(yield r.apiService.getDocs("pt_package_categories")).docs.map(d=>{let v=d.data();return v.id=d.id,v});return console.log("packages",_),_}catch(M){throw M}})()}renewPackage(r){var M=this;return(0,T.A)(function*(){try{var _,d,v;const c=new Date;r={...r,created_at:c,updated_at:c};const E=yield M.apiService.addDocument("renewals",r),f={id:E.id,...r};let P={};var u,m,p,s,n,a,i,l,y;return null!==(_=r)&&void 0!==_&&_.gym_plan&&(P={gym_plan:{id:null==E?void 0:E.id,plan:null===(u=r)||void 0===u?void 0:u.gym_plan,amount:null===(m=r)||void 0===m?void 0:m.amount,expiry_date:null===(p=r)||void 0===p?void 0:p.expiry_date,created_at:null===(s=r)||void 0===s?void 0:s.created_at}}),null!==(d=r)&&void 0!==d&&d.pt_plan&&(P={...P,pt_plan:{id:null==E?void 0:E.id,plan:null===(n=r)||void 0===n?void 0:n.pt_plan,amount:null===(a=r)||void 0===a?void 0:a.pt_amount,sessions:+(null===(i=r)||void 0===i?void 0:i.pt_sessions),sessions_used:0,expiry_date:null===(l=r)||void 0===l?void 0:l.pt_expiry_date,created_at:null===(y=r)||void 0===y?void 0:y.created_at}}),yield M.apiService.updateDocument(`students/${null===(v=r)||void 0===v?void 0:v.member_id}`,P),{updatedData:f,user_plan_data:P}}catch(c){throw c}})()}updateRenewalPackage(r,M,_){var d=this;return(0,T.A)(function*(){try{var v,u;M={...M,updated_at:new Date},yield d.apiService.updateDocument(`renewals/${null==r?void 0:r.id}`,M);let f={},P=!1;var m,p,s,n,a,i,l,y;null!==(v=M)&&void 0!==v&&v.gym_plan&&(null==r?void 0:r.id)==(null==_||null===(m=_.gym_plan)||void 0===m?void 0:m.id)&&(f={gym_plan:{id:null==r?void 0:r.id,plan:null===(p=M)||void 0===p?void 0:p.gym_plan,amount:null===(s=M)||void 0===s?void 0:s.amount,expiry_date:null===(n=M)||void 0===n?void 0:n.expiry_date,created_at:null==r?void 0:r.created_at}},P=!0),null!==(u=M)&&void 0!==u&&u.pt_plan&&(null==r?void 0:r.id)==(null==_||null===(a=_.pt_plan)||void 0===a?void 0:a.id)&&(f={...f,pt_plan:{id:null==r?void 0:r.id,plan:null===(i=M)||void 0===i?void 0:i.pt_plan,amount:null===(l=M)||void 0===l?void 0:l.pt_amount,sessions:+(null==r?void 0:r.pt_sessions),sessions_used:+(null==r?void 0:r.pt_sessions_used)||0,expiry_date:null===(y=M)||void 0===y?void 0:y.pt_expiry_date,created_at:null==r?void 0:r.created_at}},P=!0),P&&(yield d.apiService.updateDocument(`students/${null==r?void 0:r.member_id}`,f));let g=d._renewals.value;const R=g.findIndex(F=>F.id==(null==r?void 0:r.id));return-1==R?null:(g[R]={...g[R],...M},d._renewals.next(g),{updatedRecord:g[R],user_plan_data:f})}catch(c){throw c}})()}deleteRenewalPackage(r){var M=this;return(0,T.A)(function*(){try{yield M.apiService.deleteDocument(`renewals/${r}`);let d=M._renewals.value;return d=d.filter(v=>v.id!=r),M._renewals.next(d),d}catch(_){throw _}})()}getPlanHistory(r,M,_){var d=this;return(0,T.A)(function*(){try{const v=d.apiService.collectionFirestoreRef("renewals");let u=(0,w.P)(v,d.apiService.orderByQuery("created_at","desc"),d.apiService.whereQuery("member_id","==",r),d.apiService.limitQuery(M));d.lastVisible&&_&&(u=(0,w.P)(u,d.apiService.startAfterQuery(d.lastVisible)));const m=yield d.apiService.getDocsByQuery(u);d.lastVisible=m.docs[m.docs.length-1];const p=yield m.docs.map(n=>{let a=n.data();return a.id=n.id,a});console.log('data" ',p);let s=d._renewals.value||[];return s=s.concat(p),d._renewals.next(s),s}catch(v){throw v}})()}resetPlans(){this.lastVisible=null,this._renewals.next([])}}return(x=B).\u0275fac=function(r){return new(r||x)},x.\u0275prov=t.jDH({token:x,factory:x.\u0275fac,providedIn:"root"}),B})()},2109:(U,W,h)=>{h.d(W,{j:()=>M});var T=h(467),t=h(3953),e=h(4412),b=h(9350),C=h(9642),x=h(9967),B=h(3202),$=h(1626),r=h(5312);let M=(()=>{var _;class d{get trainers(){return this._trainers.asObservable()}constructor(){this._trainers=new e.t([]),this.http=(0,t.WQX)($.Qq),this.apiService=(0,t.WQX)(C.G),this.global=(0,t.WQX)(B.d)}getAllTrainers(){var u=this;return(0,T.A)(function*(){try{const m=u.apiService.collectionFirestoreRef("users"),p=(0,x.P)(m,u.apiService.whereQuery("type","==","trainer")),n=yield(yield u.apiService.getDocsByQuery(p)).docs.map(a=>{let i=a.data();return i.id=a.id,i});return console.log("orders",n),n}catch(m){throw m}})()}getTrainers(u,m){var p=this;return(0,T.A)(function*(){try{const s=p.apiService.collectionFirestoreRef("users");let n=(0,x.P)(s,p.apiService.whereQuery("type","==","trainer"),p.apiService.orderByQuery("created_at","asc"),p.apiService.limitQuery(u));p.lastVisible&&m&&(n=(0,x.P)(n,p.apiService.startAfterQuery(p.lastVisible)));const a=yield p.apiService.getDocsByQuery(n);let i=[];a.docs.length>0&&(p.lastVisible=a.docs[a.docs.length-1],console.log("last",p.lastVisible),i=yield a.docs.map(y=>{let c=y.data();return c.id=y.id,c})),console.log("orders",i);let l=p._trainers.value||[];return l=l.concat(i),p._trainers.next(l),l}catch(s){throw s}})()}getTrainer(u){var m=this;return(0,T.A)(function*(){try{const p=yield m.apiService.getDocById(`users/${u}`);if(p.exists()){let s=p.data();if(s.id=p.id,Array.isArray(s.training_type)&&s.training_type.length>0){const n=yield Promise.all(s.training_type.map(function(){var a=(0,T.A)(function*(i){const l=yield m.apiService.getDocById(`skills/${i}`);return l.exists()?{id:i,...l.data()}:(console.log(`No document found for training type id: ${i}`),null)});return function(i){return a.apply(this,arguments)}}()));s.training_type_details=n.filter(a=>null!==a)}if(Array.isArray(s.batches)&&s.batches.length>0){const n=yield Promise.all(s.batches.map(function(){var a=(0,T.A)(function*(i){const l=yield m.apiService.getDocById(`batches/${i}`);return l.exists()?{id:i,...l.data()}:(console.log(`No document found for batch id: ${i}`),null)});return function(i){return a.apply(this,arguments)}}()));s.batch_details=n.filter(a=>null!==a)}return s}throw console.log("No such document!"),"No such document!"}catch(p){throw p}})()}getSkills(){var u=this;return(0,T.A)(function*(){try{const p=yield(yield u.apiService.getDocs("skills")).docs.map(s=>{let n=s.data();return n.id=s.id,n});return console.log("skills",p),p}catch(m){throw m}})()}getBatches(){var u=this;return(0,T.A)(function*(){try{const p=yield(yield u.apiService.getDocs("batches")).docs.map(s=>{let n=s.data();return n.id=s.id,n});return console.log("batches",p),p}catch(m){throw m}})()}registerUser(u,m){var p=this;return(0,T.A)(function*(){try{const s=p.http.post(`https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=${r.c.firebase.apiKey}`,{email:u,password:m}),n=yield function w(_,d){const v="object"==typeof d;return new Promise((u,m)=>{let s,p=!1;_.subscribe({next:n=>{s=n,p=!0},error:m,complete:()=>{p?u(s):v?u(d.defaultValue):m(new b.G)}})})}(s);return console.log("registered user: ",n),null==n?void 0:n.localId}catch(s){throw s}})()}addTrainer(u,m,p){var s=this;return(0,T.A)(function*(){try{const n=s.global.getBlob(m.base64String),a=yield s.uploadPhoto(m,n);let i={...u,photo:a};if(p){const E=s.global.getBlob(null==p?void 0:p.base64String),f=yield s.uploadPhoto(p,E);i={...i,aadhar:f}}const l=yield s.registerUser(i.email,i.phone),y=yield s.apiService.setDocument(`users/${l}`,i);if(Array.isArray(i.training_type)&&i.training_type.length>0){const E=yield Promise.all(i.training_type.map(function(){var f=(0,T.A)(function*(P){const g=yield s.apiService.getDocById(`skills/${P}`);return g.exists()?{id:P,...g.data()}:(console.log(`No document found for training type id: ${P}`),null)});return function(P){return f.apply(this,arguments)}}()));i.training_type_details=E.filter(f=>null!==f)}if(Array.isArray(i.batches)&&i.batches.length>0){const E=yield Promise.all(i.batches.map(function(){var f=(0,T.A)(function*(P){const g=yield s.apiService.getDocById(`batches/${P}`);return g.exists()?{id:P,...g.data()}:(console.log(`No document found for batch id: ${P}`),null)});return function(P){return f.apply(this,arguments)}}()));i.batch_details=E.filter(f=>null!==f)}let c=[{...i,id:l}];return c=c.concat(s._trainers.value),s._trainers.next(c),y}catch(n){throw n}})()}updateTrainer(u,m,p,s){var n=this;return(0,T.A)(function*(){try{let a={...m};if(p){const c=n.global.getBlob(p.base64String),E=yield n.uploadPhoto(p,c);a={...a,photo:E}}if(s){const c=n.global.getBlob(null==s?void 0:s.base64String),E=yield n.uploadPhoto(s,c);a={...a,aadhar:E}}if(yield n.apiService.updateDocument(`users/${null==u?void 0:u.id}`,a),Array.isArray(a.training_type)&&a.training_type.length>0){const c=yield Promise.all(a.training_type.map(function(){var E=(0,T.A)(function*(f){const P=yield n.apiService.getDocById(`skills/${f}`);return P.exists()?{id:f,...P.data()}:(console.log(`No document found for training type id: ${f}`),null)});return function(f){return E.apply(this,arguments)}}()));a.training_type_details=c.filter(E=>null!==E)}if(Array.isArray(a.batches)&&a.batches.length>0){const c=yield Promise.all(a.batches.map(function(){var E=(0,T.A)(function*(f){const P=yield n.apiService.getDocById(`batches/${f}`);return P.exists()?{id:f,...P.data()}:(console.log(`No document found for batch id: ${f}`),null)});return function(f){return E.apply(this,arguments)}}()));a.batch_details=c.filter(E=>null!==E)}let l=n._trainers.value;if(0==(null==l?void 0:l.length))return{...u,...a};const y=l.findIndex(c=>c.id==u.id);return-1==y?null:(l[y]={...l[y],...a},n._trainers.next(l),l[y])}catch(a){throw a}})()}uploadPhoto(u,m){var p=this;return(0,T.A)(function*(){try{const s=Date.now();console.log(m);const n=`trainers/${s}.${u.format}`;return yield p.apiService.uploadImage(m,n)}catch(s){throw s}})()}}return(_=d).\u0275fac=function(u){return new(u||_)},_.\u0275prov=t.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),d})()}}]);