"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[881],{337:(q,y,u)=>{u.d(y,{M:()=>a});var g=u(467),n=u(3953),e=u(4341),h=u(3202),d=u(5239),E=u(3601);function f(l,o){1&l&&(n.j41(0,"div",14),n.EFF(1,"* Please select gender"),n.k0s())}function p(l,o){1&l&&(n.j41(0,"div",14),n.EFF(1,"* Please select status"),n.k0s())}function P(l,o){if(1&l){const c=n.RV6();n.j41(0,"ion-button",25),n.bIt("click",function(){n.eBV(c);const r=n.XpG();return n.Njj(r.onSubmit())}),n.j41(1,"ion-text"),n.EFF(2,"SAVE"),n.k0s()()}}function _(l,o){1&l&&(n.j41(0,"ion-button",24),n.nrm(1,"ion-spinner",26),n.k0s())}let a=(()=>{var l;class o{constructor(){this.close=new n.bkB,this.isPending=!1,this.isSave=!1,this.global=(0,n.WQX)(h.d),this.enquiryService=(0,n.WQX)(E.X)}ngOnInit(){this.initForm(),this.id&&this.getData()}initForm(){this.form=new e.gE({name:new e.MJ(null,{validators:[e.k0.required]}),status:new e.MJ("Pending",{validators:[e.k0.required]}),phone:new e.MJ(null,{validators:[e.k0.required,e.k0.minLength(10),e.k0.maxLength(10)]}),gender:new e.MJ(null,{validators:[e.k0.required]}),address:new e.MJ(null,{validators:[e.k0.required]}),reference:new e.MJ(null,{validators:[]}),remarks:new e.MJ(null,{validators:[]})})}getData(){var i=this;return(0,g.A)(function*(){try{i.global.showLoader(),i.item=yield i.enquiryService.getEnquiryById(i.id),i.updateRecords(),i.global.hideLoader()}catch(r){console.log(r),i.global.hideLoader(),i.global.checkMessageForErrorToast(r)}})()}updateRecords(){this.form.patchValue({...this.item})}dismiss(i){this.close.emit(i)}onSubmit(){this.form.valid?this.save():this.form.markAllAsTouched()}save(){var i=this;return(0,g.A)(function*(){try{i.isSave=!0;const r=new Date;let t={...i.form.value,updated_at:r};if(console.log(t),i.id)yield i.enquiryService.updateEnquiry(i.id,t);else{t={...t,created_at:r};const s=yield i.enquiryService.addEnquiry(t,i.isPending);console.log(s)}i.isSave=!1,i.dismiss()}catch(r){console.log(r),i.isSave=!1,i.global.checkMessageForErrorToast(r)}})()}}return(l=o).\u0275fac=function(i){return new(i||l)},l.\u0275cmp=n.VBU({type:l,selectors:[["app-add-enquiry"]],inputs:{id:"id",isPending:"isPending"},outputs:{close:"close"},standalone:!0,features:[n.aNF],decls:51,vars:8,consts:[["slot","start"],[3,"click"],["name","arrow-back"],["color","primary",3,"fullscreen"],[3,"formGroup"],[1,"form-row"],["sizeLg","6","sizeMd","6","sizeSm","12","sizeXl","6","sizeXs","12"],[1,"col-input"],["label","NAME","labelPlacement","floating","type","text","formControlName","name","errorText","* Please enter proper name."],["label","PHONE","labelPlacement","floating","formControlName","phone","type","number",3,"errorText"],["label","GENDER","labelPlacement","fixed","formControlName","gender","interface","popover","placeholder","Select Gender"],["value","M"],["value","F"],["value","T"],[1,"error"],["label","ADDRESS","labelPlacement","floating","rows","1","formControlName","address","errorText","* Please provide your address",3,"autoGrow"],["label","STATUS","labelPlacement","fixed","formControlName","status","interface","popover","placeholder","Select Status"],["value","Pending"],["value","Became Member"],["value","Not Interested"],["value","Interested later"],["label","REFERENCE (if any)","labelPlacement","floating","formControlName","reference","type","text","errorText",""],["label","REMARKS (if any)","labelPlacement","floating","rows","2","formControlName","remarks",3,"autoGrow"],[1,"ion-margin"],["expand","block","size","large","shape","round","color","tertiary"],["expand","block","size","large","shape","round","color","tertiary",3,"click"],["name","crescent","color","light"]],template:function(i,r){1&i&&(n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n.EFF(3,"Add Enquiry"),n.k0s(),n.j41(4,"ion-buttons",0)(5,"ion-button",1),n.bIt("click",function(){return r.dismiss()}),n.nrm(6,"ion-icon",2),n.k0s()()()(),n.j41(7,"ion-content",3)(8,"ion-card")(9,"form",4)(10,"ion-row",5)(11,"ion-col",6)(12,"div",7),n.nrm(13,"ion-input",8),n.k0s()(),n.j41(14,"ion-col",6)(15,"div",7),n.nrm(16,"ion-input",9),n.k0s()(),n.j41(17,"ion-col",6)(18,"div",7)(19,"ion-select",10)(20,"ion-select-option",11),n.EFF(21,"Male"),n.k0s(),n.j41(22,"ion-select-option",12),n.EFF(23,"Female"),n.k0s(),n.j41(24,"ion-select-option",13),n.EFF(25,"Transgender"),n.k0s()(),n.DNE(26,f,2,0,"div",14),n.k0s()(),n.j41(27,"ion-col",6)(28,"div",7),n.nrm(29,"ion-textarea",15),n.k0s()(),n.j41(30,"ion-col",6)(31,"div",7)(32,"ion-select",16)(33,"ion-select-option",17),n.EFF(34,"Pending"),n.k0s(),n.j41(35,"ion-select-option",18),n.EFF(36,"Became Member"),n.k0s(),n.j41(37,"ion-select-option",19),n.EFF(38,"Not Interested"),n.k0s(),n.j41(39,"ion-select-option",20),n.EFF(40,"Interested later"),n.k0s()(),n.DNE(41,p,2,0,"div",14),n.k0s()(),n.j41(42,"ion-col",6)(43,"div",7),n.nrm(44,"ion-input",21),n.k0s()(),n.j41(45,"ion-col",6)(46,"div",7),n.nrm(47,"ion-textarea",22),n.k0s()()()(),n.j41(48,"div",23),n.DNE(49,P,3,0,"ion-button",24)(50,_,2,0,"ion-button",24),n.k0s()()()),2&i&&(n.R7$(7),n.Y8G("fullscreen",!0),n.R7$(2),n.Y8G("formGroup",r.form),n.R7$(7),n.Y8G("errorText",r.form.get("phone").hasError("minlength")||r.form.get("phone").hasError("maxlength")?"* Please enter your 10 digits Phone number.":"* Please enter your Phone number"),n.R7$(10),n.vxM(r.form.get("gender").touched&&r.form.get("gender").hasError("required")?26:-1),n.R7$(3),n.Y8G("autoGrow",!0),n.R7$(12),n.vxM(r.form.get("status").touched&&r.form.get("status").hasError("required")?41:-1),n.R7$(6),n.Y8G("autoGrow",!0),n.R7$(2),n.vxM(r.isSave?50:49))},dependencies:[d.nc,d.IO,d.w2,d.$w,d.hU,d.ln,d.b_,d.W9,d.iq,d.Jm,d.QW,d.BC,d.ai,d.eU,d.Nm,d.Ip,e.X1,e.qT,e.BC,e.cb,e.j4,e.JD]}),o})()},2625:(q,y,u)=>{u.d(y,{P:()=>c});var g=u(467),n=u(8655),e=u(3953),h=u(3202),d=u(3601),E=u(9685),f=u(177),p=u(5239);function P(i,r){if(1&i&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(null==t?null:t.reference)}}function _(i,r){if(1&i&&(e.j41(0,"div",9)(1,"ion-label",1),e.EFF(2),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" ",null==t?null:t.remarks," ")}}function a(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-card")(1,"ion-item-sliding")(2,"ion-item")(3,"ion-label",1),e.EFF(4),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.nI1(9,"timestampToDate"),e.nI1(10,"date"),e.k0s(),e.j41(11,"p"),e.EFF(12),e.k0s(),e.DNE(13,P,2,1,"p"),e.k0s(),e.j41(14,"ion-fab-button",2),e.bIt("click",function(){const m=e.eBV(t).$implicit,v=e.XpG(2);return e.Njj(v.global.call(null==m?null:m.phone))}),e.nrm(15,"ion-icon",3),e.k0s()(),e.j41(16,"ion-item-options",4)(17,"ion-item-option",5),e.bIt("click",function(){const m=e.eBV(t).$implicit,v=e.XpG(2);return e.Njj(v.editEnquiry(m))}),e.nrm(18,"ion-icon",6),e.EFF(19," Edit "),e.k0s(),e.j41(20,"ion-item-option",7),e.bIt("click",function(){const m=e.eBV(t).$implicit,v=e.XpG(2);return e.Njj(v.deleteEnquiryAlert(m))}),e.nrm(21,"ion-icon",8),e.EFF(22," Delete "),e.k0s()()(),e.DNE(23,_,3,1,"div",9),e.k0s()}if(2&i){const t=r.$implicit;e.R7$(4),e.Lme(" ",null==t?null:t.name," (",null==t?null:t.gender,") "),e.R7$(2),e.SpI(" ",null==t?null:t.address," "),e.R7$(2),e.SpI(" ",e.i5U(10,9,e.bMT(9,7,null==t?null:t.updated_at),"MMM d, y")," "),e.R7$(4),e.JRh(null==t?null:t.status),e.R7$(),e.vxM(null!=t&&t.reference?13:-1),e.R7$(10),e.vxM(null!=t&&t.remarks?23:-1)}}function l(i,r){if(1&i&&(e.j41(0,"ion-list"),e.Z7z(1,a,24,12,"ion-card",null,e.Vm6),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Dyx(t.enquiries)}}function o(i,r){if(1&i&&e.nrm(0,"app-empty-screen",0),2&i){const t=e.XpG();e.Y8G("model",t.emptyModel)("fontSize",t.emptyScreenSmall?"10rem":"18rem")("isMargin",t.emptyScreenSmall?"translateY(2vh)":"translateY(10vh)")}}let c=(()=>{var i;class r{constructor(){this.enquiries=[],this.isPending=!1,this.emptyScreenSmall=!1,this.emptyModel={title:"No enquires yet",icon:"document-text-outline"},this.edit=new e.bkB,this.global=(0,e.WQX)(h.d),this.enquiryService=(0,e.WQX)(d.X)}ngOnInit(){}deleteEnquiryAlert(s){this.global.showAlert(`Are you sure you want to exclude '${null==s?void 0:s.name}' from the list?`,"Confirm",[{text:"No",role:"cancel"},{text:"Yes",handler:()=>{this.deleteEnquiry(s)}}])}editEnquiry(s){this.edit.emit(null==s?void 0:s.id)}deleteEnquiry(s){var m=this;return(0,g.A)(function*(){try{m.global.showLoader();const v=yield m.enquiryService.deleteEnquiry(null==s?void 0:s.id);console.log(v),m.global.hideLoader()}catch(v){m.global.hideLoader(),console.log(v),m.global.checkMessageForErrorToast(v)}})()}}return(i=r).\u0275fac=function(s){return new(s||i)},i.\u0275cmp=e.VBU({type:i,selectors:[["app-enquiry-component"]],inputs:{enquiries:"enquiries",isPending:"isPending",emptyScreenSmall:"emptyScreenSmall"},outputs:{edit:"edit"},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[[3,"model","fontSize","isMargin"],[1,"ion-text-wrap"],["slot","end","size","small",1,"call-button",3,"click"],["name","call-outline"],["side","end"],["color","tertiary",3,"click"],["slot","top","name","create-outline"],["color","danger",3,"click"],["slot","top","name","trash-outline"],[1,"ion-margin"]],template:function(s,m){1&s&&e.DNE(0,l,3,0,"ion-list")(1,o,1,3,"app-empty-screen",0),2&s&&e.vxM(m.enquiries.length>0?0:1)},dependencies:[p.LU,p.CE,p.iq,p.YW,p.he,p.uz,p.A7,p.b_,p.nf,E.i,f.vh,n.V],styles:["ion-list[_ngcontent-%COMP%]{background:transparent}ion-list[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid var(--ion-color-primary);--border-radius: 8px;padding:.3rem .1rem}ion-list[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}ion-list[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;margin-top:5px;font-weight:400}ion-list[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.8rem}"]}),r})()},9685:(q,y,u)=>{u.d(y,{i:()=>n});var g=u(3953);let n=(()=>{var e;class h{transform(E){return E?null!=E&&E.seconds?new Date(1e3*(E.seconds||0)+(E.nanoseconds||0)/1e6):E:null}}return(e=h).\u0275fac=function(E){return new(E||e)},e.\u0275pipe=g.EJ8({name:"timestampToDate",type:e,pure:!0,standalone:!0}),h})()},3601:(q,y,u)=>{u.d(y,{X:()=>E});var g=u(467),n=u(3953),e=u(4412),h=u(9642),d=u(2784);let E=(()=>{var f;class p{get enquiries(){return this._enquiries.asObservable()}get pendingEnquiries(){return this._pendingEnquiries.asObservable()}constructor(){this._enquiries=new e.t([]),this._pendingEnquiries=new e.t([]),this.apiService=(0,n.WQX)(h.G)}getEnquiries(_,a,l){var o=this;return(0,g.A)(function*(){try{const c=o.apiService.collectionFirestoreRef("enquiries");let i=(0,d.P)(c,o.apiService.orderByQuery("created_at","desc"),o.apiService.limitQuery(_));a&&(i=(0,d.P)(i,o.apiService.whereQuery("status","==","Pending"))),o.lastVisible&&l&&!a?i=(0,d.P)(i,o.apiService.startAfterQuery(o.lastVisible)):o.lastVisiblePending&&l&&a&&(i=(0,d.P)(i,o.apiService.startAfterQuery(o.lastVisiblePending)));const r=yield o.apiService.getDocsByQuery(i);a?o.lastVisiblePending=r.docs[r.docs.length-1]:o.lastVisible=r.docs[r.docs.length-1],console.log("last",a?o.lastVisiblePending:o.lastVisible);const t=yield r.docs.map(m=>{let v=m.data();return v.id=m.id,v});console.log('enquiries" ',t);let s=(a?o._pendingEnquiries.value:o._enquiries.value)||[];return s=s.concat(t),a?o._pendingEnquiries.next(s):o._enquiries.next(s),t}catch(c){throw c}})()}addEnquiry(_,a=!1){var l=this;return(0,g.A)(function*(){try{const o=yield l.apiService.addDocument("enquiries",_);if(!a){let c=[{..._,id:null==o?void 0:o.id}];c=c.concat(l._enquiries.value),l._enquiries.next(c)}if("Pending"==(null==_?void 0:_.status)){let c=[{..._,id:null==o?void 0:o.id}];c=c.concat(l._pendingEnquiries.value),l._pendingEnquiries.next(c)}return o}catch(o){throw o}})()}updateEnquiry(_,a){var l=this;return(0,g.A)(function*(){try{const o=yield l.apiService.updateDocument("enquiries/"+_,a);let c=l._enquiries.value;const i=c.findIndex(t=>t.id==_);console.log(i),i>=0&&(c[i]={...c[i],...a,id:_},console.log(c),l._enquiries.next(c));let r=l._pendingEnquiries.value;if("Pending"==(null==a?void 0:a.status)){const t=r.findIndex(s=>s.id==_);if(console.log(t),-1==t)return null;r[t]={...r[t],...a,id:_},console.log(r)}else r=r.filter(t=>t.id!=_);return l._pendingEnquiries.next(r),o}catch(o){throw o}})()}getEnquiryById(_){var a=this;return(0,g.A)(function*(){try{const l=yield a.apiService.getDocById(`enquiries/${_}`);if(null!=l&&l.exists())return l.data();throw console.log("No such document!"),"No such document!"}catch(l){throw l}})()}deleteEnquiry(_){var a=this;return(0,g.A)(function*(){try{const l=yield a.apiService.deleteDocument(`enquiries/${_}`);console.log(l);let o=a._enquiries.value;o=o.filter(i=>i.id!=_),a._enquiries.next(o);let c=a._pendingEnquiries.value;return c=c.filter(i=>i.id!=_),a._pendingEnquiries.next(c),o}catch(l){throw l}})()}reset(){this._enquiries.next([]),this.lastVisible=null}resetPending(){this._pendingEnquiries.next([]),this.lastVisiblePending=null}}return(f=p).\u0275fac=function(_){return new(_||f)},f.\u0275prov=n.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),p})()}}]);